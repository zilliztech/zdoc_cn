{
  "creator": "ou_8554528ee6e965bad56710acde1c7847",
  "has_child": false,
  "node_create_time": "1687683862",
  "node_token": "QdD7w2k6ii7mKFkTJ2tcNhYznAf",
  "node_type": "origin",
  "obj_create_time": "1687683862",
  "obj_edit_time": "1700705659",
  "obj_token": "TyZJdWsxtoGoBIxtYtic08dnnXe",
  "obj_type": "docx",
  "origin_node_token": "QdD7w2k6ii7mKFkTJ2tcNhYznAf",
  "origin_space_id": "7167193056431783939",
  "owner": "ou_8554528ee6e965bad56710acde1c7847",
  "parent_node_token": "B11mwdhmYiGFsck0eCYcU5wnngX",
  "space_id": "7167193056431783939",
  "title": "与 SentenceTransformers 集成搭建电影搜索系统",
  "slug": "movie-search-using-zilliz-cloud-and-sentencetransformers",
  "blocks": {
    "items": [
      {
        "block_id": "TyZJdWsxtoGoBIxtYtic08dnnXe",
        "block_type": 1,
        "children": [
          "GaquduqnmoGoC2xsUzIciMCZnZc",
          "Sj0XdYFHVojFFMxC3Zgcp0lCn1e",
          "AtkudXkEXoz8jSx41zIcCaQanjg",
          "MZ28dmXx5ohmCdxF9BycusPGn2g",
          "YKh6dWoGQouEc6xQ8rQcwznknMc",
          "U2yEdjQluoZSWexMjj3cUGwvnvf",
          "AxTldXjBaovQWmx4eK5cTe5Pnaf",
          "GlEAdWfeYoFmifxoyB5cXwx7ngc",
          "ZH2EdswjSoc1yCxoBeJcg3jHn1b",
          "NVRwddqPWoXZMTxpDFLcNzuXnHf",
          "SkD8dsihxo73RjxXO6acO265nCd",
          "Njbmd8AbwoaqvYxsRkMcCWTrnYe",
          "HuwwdeooyoRYGHx34aXc1GS9nwg",
          "OB2gdLPxroSuDrxqj3ccbJhUnYf",
          "U0xxdoLE9o5plcxre3PcOGyungb",
          "K0YKd7sKZoosimxI7vDcCINwnUc",
          "J3g9dc9gMovOqpxfMOCc6kVUnfg",
          "Mj1tdQyoeotTIwxcWXOcDUmQnGd",
          "MhlMdZuB1oPHB1xK6uIc5xELnjc",
          "V1CDdmGELovmwJxIjmxccrUxnRh",
          "IJCMduEPuoBZTdxmRdWc7felnFe",
          "NrmqdpV5oou4NdxG3KacCcVZnJd",
          "AJecd3EyioYJIzxmLa4cO7EjnW4",
          "LJEbdGGIVoSQsgxGr7FcV5rknsh",
          "WALqdxJlKod2v1xN77ecO9hYnFf",
          "CHwvdHZX8oJyaBxvbG5cGOrCnjb",
          "HQH9dlBUco6uH3xgpxPczhVbnVd",
          "JoKOdcHZyo7qpBx0VEgccBxmnBf",
          "BILRdxjyGoE8rnxYnzvcPWlwnjf",
          "FywNdcZgqo3YVnx5O16c4u1Enwc"
        ],
        "page": {
          "elements": [
            {
              "text_run": {
                "content": "与 SentenceTransformers 集成搭建电影搜索系统",
                "text_element_style": {
                  "bold": false,
                  "inline_code": false,
                  "italic": false,
                  "strikethrough": false,
                  "underline": false
                }
              }
            }
          ],
          "style": {
            "align": 1
          }
        },
        "parent_id": ""
      },
      {
        "block_id": "GaquduqnmoGoC2xsUzIciMCZnZc",
        "block_type": 2,
        "parent_id": "TyZJdWsxtoGoBIxtYtic08dnnXe",
        "text": {
          "elements": [
            {
              "text_run": {
                "content": "本文将演示使用 Zilliz Cloud 和 SentenceTransformers 对一篇 Wikipedia 文章进行搜索。示例中用到的数据集为 Wikipedia-Movie-Plots Dataset，你可以在 ",
                "text_element_style": {
                  "bold": false,
                  "inline_code": false,
                  "italic": false,
                  "strikethrough": false,
                  "underline": false
                }
              }
            },
            {
              "text_run": {
                "content": "Kaggle",
                "text_element_style": {
                  "bold": false,
                  "inline_code": false,
                  "italic": false,
                  "link": {
                    "url": "https%3A%2F%2Fwww.kaggle.com%2Fdatasets%2Fjrobischon%2Fwikipedia-movie-plots"
                  },
                  "strikethrough": false,
                  "underline": false
                }
              }
            },
            {
              "text_run": {
                "content": " 上找到该数据集。我们将该数据集重新托管到了一个公共的 Google Drive。",
                "text_element_style": {
                  "bold": false,
                  "inline_code": false,
                  "italic": false,
                  "strikethrough": false,
                  "underline": false
                }
              }
            }
          ],
          "style": {
            "align": 1,
            "folded": false
          }
        }
      },
      {
        "block_id": "Sj0XdYFHVojFFMxC3Zgcp0lCn1e",
        "block_type": 2,
        "parent_id": "TyZJdWsxtoGoBIxtYtic08dnnXe",
        "text": {
          "elements": [
            {
              "text_run": {
                "content": "您需要在 Zilliz Cloud 上创建一个大小为 1 CU 的 Cluster。",
                "text_element_style": {
                  "bold": false,
                  "inline_code": false,
                  "italic": false,
                  "strikethrough": false,
                  "underline": false
                }
              }
            }
          ],
          "style": {
            "align": 1,
            "folded": false
          }
        }
      },
      {
        "block_id": "AtkudXkEXoz8jSx41zIcCaQanjg",
        "block_type": 4,
        "heading2": {
          "elements": [
            {
              "text_run": {
                "content": "准备工作",
                "text_element_style": {
                  "bold": false,
                  "inline_code": false,
                  "italic": false,
                  "strikethrough": false,
                  "underline": false
                }
              }
            },
            {
              "text_run": {
                "content": "{#before-you-start}",
                "text_element_style": {
                  "bold": false,
                  "inline_code": false,
                  "italic": false,
                  "strikethrough": false,
                  "underline": false
                }
              }
            }
          ],
          "style": {
            "align": 1,
            "folded": false
          }
        },
        "parent_id": "TyZJdWsxtoGoBIxtYtic08dnnXe"
      },
      {
        "block_id": "MZ28dmXx5ohmCdxF9BycusPGn2g",
        "block_type": 2,
        "parent_id": "TyZJdWsxtoGoBIxtYtic08dnnXe",
        "text": {
          "elements": [
            {
              "text_run": {
                "content": "在本示例中，我们将使用 ",
                "text_element_style": {
                  "bold": false,
                  "inline_code": false,
                  "italic": false,
                  "strikethrough": false,
                  "underline": false
                }
              }
            },
            {
              "text_run": {
                "content": "pymilvus",
                "text_element_style": {
                  "bold": true,
                  "inline_code": false,
                  "italic": false,
                  "strikethrough": false,
                  "underline": false
                }
              }
            },
            {
              "text_run": {
                "content": " 连接 Zilliz Cloud，使用 ",
                "text_element_style": {
                  "bold": false,
                  "inline_code": false,
                  "italic": false,
                  "strikethrough": false,
                  "underline": false
                }
              }
            },
            {
              "text_run": {
                "content": "sentencetransformers",
                "text_element_style": {
                  "bold": true,
                  "inline_code": false,
                  "italic": false,
                  "strikethrough": false,
                  "underline": false
                }
              }
            },
            {
              "text_run": {
                "content": " 来生成向量，并使用 ",
                "text_element_style": {
                  "bold": false,
                  "inline_code": false,
                  "italic": false,
                  "strikethrough": false,
                  "underline": false
                }
              }
            },
            {
              "text_run": {
                "content": "gdown",
                "text_element_style": {
                  "bold": true,
                  "inline_code": false,
                  "italic": false,
                  "strikethrough": false,
                  "underline": false
                }
              }
            },
            {
              "text_run": {
                "content": " 来下载示例数据集。",
                "text_element_style": {
                  "bold": false,
                  "inline_code": false,
                  "italic": false,
                  "strikethrough": false,
                  "underline": false
                }
              }
            }
          ],
          "style": {
            "align": 1,
            "folded": false
          }
        }
      },
      {
        "block_id": "YKh6dWoGQouEc6xQ8rQcwznknMc",
        "block_type": 14,
        "code": {
          "elements": [
            {
              "text_run": {
                "content": "pip install pymilvus sentence-transformers gdown",
                "text_element_style": {
                  "bold": false,
                  "inline_code": false,
                  "italic": false,
                  "strikethrough": false,
                  "underline": false
                }
              }
            }
          ],
          "style": {
            "language": 49,
            "wrap": false
          }
        },
        "parent_id": "TyZJdWsxtoGoBIxtYtic08dnnXe"
      },
      {
        "block_id": "U2yEdjQluoZSWexMjj3cUGwvnvf",
        "block_type": 4,
        "heading2": {
          "elements": [
            {
              "text_run": {
                "content": "准备数据",
                "text_element_style": {
                  "bold": false,
                  "inline_code": false,
                  "italic": false,
                  "strikethrough": false,
                  "underline": false
                }
              }
            },
            {
              "text_run": {
                "content": "{#prepare-data}",
                "text_element_style": {
                  "bold": false,
                  "inline_code": false,
                  "italic": false,
                  "strikethrough": false,
                  "underline": false
                }
              }
            }
          ],
          "style": {
            "align": 1,
            "folded": false
          }
        },
        "parent_id": "TyZJdWsxtoGoBIxtYtic08dnnXe"
      },
      {
        "block_id": "AxTldXjBaovQWmx4eK5cTe5Pnaf",
        "block_type": 2,
        "parent_id": "TyZJdWsxtoGoBIxtYtic08dnnXe",
        "text": {
          "elements": [
            {
              "text_run": {
                "content": "首先，我们要使用 ",
                "text_element_style": {
                  "bold": false,
                  "inline_code": false,
                  "italic": false,
                  "strikethrough": false,
                  "underline": false
                }
              }
            },
            {
              "text_run": {
                "content": "gdown",
                "text_element_style": {
                  "bold": true,
                  "inline_code": false,
                  "italic": false,
                  "strikethrough": false,
                  "underline": false
                }
              }
            },
            {
              "text_run": {
                "content": " 从公共 Google Drive 中下载数据集压缩包，然后使用 Python 自带的 ",
                "text_element_style": {
                  "bold": false,
                  "inline_code": false,
                  "italic": false,
                  "strikethrough": false,
                  "underline": false
                }
              }
            },
            {
              "text_run": {
                "content": "zipfile",
                "text_element_style": {
                  "bold": true,
                  "inline_code": false,
                  "italic": false,
                  "strikethrough": false,
                  "underline": false
                }
              }
            },
            {
              "text_run": {
                "content": " 对该压缩包进行解压缩。",
                "text_element_style": {
                  "bold": false,
                  "inline_code": false,
                  "italic": false,
                  "strikethrough": false,
                  "underline": false
                }
              }
            }
          ],
          "style": {
            "align": 1,
            "folded": false
          }
        }
      },
      {
        "block_id": "GlEAdWfeYoFmifxoyB5cXwx7ngc",
        "block_type": 14,
        "code": {
          "elements": [
            {
              "text_run": {
                "content": "import gdown\nurl = 'https://drive.google.com/uc?id=11ISS45aO2ubNCGaC3Lvd3D7NT8Y7MeO8'\noutput = './movies.zip'\ngdown.download(url, output)\n\nimport zipfile\n\nwith zipfile.ZipFile(\"./movies.zip\",\"r\") as zip_ref:\n",
                "text_element_style": {
                  "bold": false,
                  "inline_code": false,
                  "italic": false,
                  "strikethrough": false,
                  "underline": false
                }
              }
            },
            {
              "text_run": {
                "content": "    zip_ref.extractall(\"./movies\")",
                "text_element_style": {
                  "bold": false,
                  "inline_code": false,
                  "italic": false,
                  "strikethrough": false,
                  "underline": false
                }
              }
            }
          ],
          "style": {
            "language": 49,
            "wrap": false
          }
        },
        "parent_id": "TyZJdWsxtoGoBIxtYtic08dnnXe"
      },
      {
        "block_id": "ZH2EdswjSoc1yCxoBeJcg3jHn1b",
        "block_type": 4,
        "heading2": {
          "elements": [
            {
              "text_run": {
                "content": "主要参数",
                "text_element_style": {
                  "bold": false,
                  "inline_code": false,
                  "italic": false,
                  "strikethrough": false,
                  "underline": false
                }
              }
            },
            {
              "text_run": {
                "content": "{#parameters}",
                "text_element_style": {
                  "bold": false,
                  "inline_code": false,
                  "italic": false,
                  "strikethrough": false,
                  "underline": false
                }
              }
            }
          ],
          "style": {
            "align": 1,
            "folded": false
          }
        },
        "parent_id": "TyZJdWsxtoGoBIxtYtic08dnnXe"
      },
      {
        "block_id": "NVRwddqPWoXZMTxpDFLcNzuXnHf",
        "block_type": 2,
        "parent_id": "TyZJdWsxtoGoBIxtYtic08dnnXe",
        "text": {
          "elements": [
            {
              "text_run": {
                "content": "本示例中使用的主要公共参数都在此处定义。请根据需求修改参数值。",
                "text_element_style": {
                  "bold": false,
                  "inline_code": false,
                  "italic": false,
                  "strikethrough": false,
                  "underline": false
                }
              }
            }
          ],
          "style": {
            "align": 1,
            "folded": false
          }
        }
      },
      {
        "block_id": "SkD8dsihxo73RjxXO6acO265nCd",
        "block_type": 14,
        "code": {
          "elements": [
            {
              "text_run": {
                "content": "# Zilliz Cloud 设置参数\nCOLLECTION_NAME = 'movies_db'  # Collection 名称\nDIMENSION = 384  # 向量维度\nURI = 'https://replace-this-with-your-zilliz-cloud-endpoint'  # Cluster 公共端点 URI, 可从 Zilliz Cloud 获取 \nUSER = 'replace-this-with-your-zilliz-cloud-database-user'  # 创建 Cluster 时指定的用户名\nPASSWORD = 'replace-this-with-your-zilliz-cloud-database-password'  # 上述用户名对应的密码\n\n# 推理参数\nBATCH_SIZE = 128\n\n# 搜索参数\n",
                "text_element_style": {
                  "bold": false,
                  "inline_code": false,
                  "italic": false,
                  "strikethrough": false,
                  "underline": false
                }
              }
            },
            {
              "text_run": {
                "content": "TOP_K = 3",
                "text_element_style": {
                  "bold": false,
                  "inline_code": false,
                  "italic": false,
                  "strikethrough": false,
                  "underline": false
                }
              }
            }
          ],
          "style": {
            "language": 49,
            "wrap": false
          }
        },
        "parent_id": "TyZJdWsxtoGoBIxtYtic08dnnXe"
      },
      {
        "block_id": "Njbmd8AbwoaqvYxsRkMcCWTrnYe",
        "block_type": 4,
        "heading2": {
          "elements": [
            {
              "text_run": {
                "content": "设置 Zilliz Cloud",
                "text_element_style": {
                  "bold": false,
                  "inline_code": false,
                  "italic": false,
                  "strikethrough": false,
                  "underline": false
                }
              }
            },
            {
              "text_run": {
                "content": "{#set-up-zilliz-cloud}",
                "text_element_style": {
                  "bold": false,
                  "inline_code": false,
                  "italic": false,
                  "strikethrough": false,
                  "underline": false
                }
              }
            }
          ],
          "style": {
            "align": 1,
            "folded": false
          }
        },
        "parent_id": "TyZJdWsxtoGoBIxtYtic08dnnXe"
      },
      {
        "block_id": "HuwwdeooyoRYGHx34aXc1GS9nwg",
        "block_type": 2,
        "parent_id": "TyZJdWsxtoGoBIxtYtic08dnnXe",
        "text": {
          "elements": [
            {
              "text_run": {
                "content": "在这一小节，我们将完成 Zilliz Cloud 的设置，涉及如下步骤：",
                "text_element_style": {
                  "bold": false,
                  "inline_code": false,
                  "italic": false,
                  "strikethrough": false,
                  "underline": false
                }
              }
            }
          ],
          "style": {
            "align": 1,
            "folded": false
          }
        }
      },
      {
        "block_id": "OB2gdLPxroSuDrxqj3ccbJhUnYf",
        "block_type": 13,
        "children": [
          "GIe3d62cUojIsTxCSt2cdcxWnle"
        ],
        "ordered": {
          "elements": [
            {
              "text_run": {
                "content": "使用提供的端点 ",
                "text_element_style": {
                  "bold": false,
                  "inline_code": false,
                  "italic": false,
                  "strikethrough": false,
                  "underline": false
                }
              }
            },
            {
              "text_run": {
                "content": "URI",
                "text_element_style": {
                  "bold": false,
                  "inline_code": false,
                  "italic": false,
                  "strikethrough": false,
                  "underline": false
                }
              }
            },
            {
              "text_run": {
                "content": " 连接 Zilliz Cloud cluster。",
                "text_element_style": {
                  "bold": false,
                  "inline_code": false,
                  "italic": false,
                  "strikethrough": false,
                  "underline": false
                }
              }
            }
          ],
          "style": {
            "align": 1,
            "folded": false
          }
        },
        "parent_id": "TyZJdWsxtoGoBIxtYtic08dnnXe"
      },
      {
        "block_id": "GIe3d62cUojIsTxCSt2cdcxWnle",
        "block_type": 14,
        "code": {
          "elements": [
            {
              "text_run": {
                "content": "from pymilvus import connections\n\n# 连接 Cluster\n",
                "text_element_style": {
                  "bold": false,
                  "inline_code": false,
                  "italic": false,
                  "strikethrough": false,
                  "underline": false
                }
              }
            },
            {
              "text_run": {
                "content": "connections.connect(uri=URI, user=USER, password=PASSWORD, secure=True)",
                "text_element_style": {
                  "bold": false,
                  "inline_code": false,
                  "italic": false,
                  "strikethrough": false,
                  "underline": false
                }
              }
            }
          ],
          "style": {
            "language": 49,
            "wrap": false
          }
        },
        "parent_id": "OB2gdLPxroSuDrxqj3ccbJhUnYf"
      },
      {
        "block_id": "U0xxdoLE9o5plcxre3PcOGyungb",
        "block_type": 13,
        "children": [
          "WmNKdBJDOoOhKDxGQWEc1O7Inkb"
        ],
        "ordered": {
          "elements": [
            {
              "text_run": {
                "content": "如果需要创建的 Collection 已存在，删除该 Collection。",
                "text_element_style": {
                  "bold": false,
                  "inline_code": false,
                  "italic": false,
                  "strikethrough": false,
                  "underline": false
                }
              }
            }
          ],
          "style": {
            "align": 1,
            "folded": false
          }
        },
        "parent_id": "TyZJdWsxtoGoBIxtYtic08dnnXe"
      },
      {
        "block_id": "WmNKdBJDOoOhKDxGQWEc1O7Inkb",
        "block_type": 14,
        "code": {
          "elements": [
            {
              "text_run": {
                "content": "from pymilvus import utility\n\n# 删除已存在的同名 Collection\nif utility.has_collection(COLLECTION_NAME):\n",
                "text_element_style": {
                  "bold": false,
                  "inline_code": false,
                  "italic": false,
                  "strikethrough": false,
                  "underline": false
                }
              }
            },
            {
              "text_run": {
                "content": "    utility.drop_collection(COLLECTION_NAME)",
                "text_element_style": {
                  "bold": false,
                  "inline_code": false,
                  "italic": false,
                  "strikethrough": false,
                  "underline": false
                }
              }
            }
          ],
          "style": {
            "language": 49,
            "wrap": false
          }
        },
        "parent_id": "U0xxdoLE9o5plcxre3PcOGyungb"
      },
      {
        "block_id": "K0YKd7sKZoosimxI7vDcCINwnUc",
        "block_type": 13,
        "children": [
          "R9N3dUAA0ogOYDxkeRYcRVN3neb"
        ],
        "ordered": {
          "elements": [
            {
              "text_run": {
                "content": "创建一个 Collection 用于存储电影 ID，电影名称以及该名称的向量表示。",
                "text_element_style": {
                  "bold": false,
                  "inline_code": false,
                  "italic": false,
                  "strikethrough": false,
                  "underline": false
                }
              }
            }
          ],
          "style": {
            "align": 1,
            "folded": false
          }
        },
        "parent_id": "TyZJdWsxtoGoBIxtYtic08dnnXe"
      },
      {
        "block_id": "R9N3dUAA0ogOYDxkeRYcRVN3neb",
        "block_type": 14,
        "code": {
          "elements": [
            {
              "text_run": {
                "content": "from pymilvus import FieldSchema, CollectionSchema, DataType, Collection\n\n# 创建一个 Collection，包含 id，title 和 embedding 三个字段\nfields = [\n    FieldSchema(name='id', dtype=DataType.INT64, is_primary=True, auto_id=True),\n    FieldSchema(name='title', dtype=DataType.VARCHAR, max_length=200),  # VARCHARS need a maximum length, so for this example they are set to 200 characters\n    FieldSchema(name='embedding', dtype=DataType.FLOAT_VECTOR, dim=DIMENSION)\n]\nschema = CollectionSchema(fields=fields)\n",
                "text_element_style": {
                  "bold": false,
                  "inline_code": false,
                  "italic": false,
                  "strikethrough": false,
                  "underline": false
                }
              }
            },
            {
              "text_run": {
                "content": "collection = Collection(name=COLLECTION_NAME, schema=schema)",
                "text_element_style": {
                  "bold": false,
                  "inline_code": false,
                  "italic": false,
                  "strikethrough": false,
                  "underline": false
                }
              }
            }
          ],
          "style": {
            "language": 49,
            "wrap": false
          }
        },
        "parent_id": "K0YKd7sKZoosimxI7vDcCINwnUc"
      },
      {
        "block_id": "J3g9dc9gMovOqpxfMOCc6kVUnfg",
        "block_type": 13,
        "children": [
          "FmtEdXaINoTUTIxSqixcBnzunrg"
        ],
        "ordered": {
          "elements": [
            {
              "text_run": {
                "content": "为 Collection 创建索引文件，并将 Collection 加载到内存。",
                "text_element_style": {
                  "bold": false,
                  "inline_code": false,
                  "italic": false,
                  "strikethrough": false,
                  "underline": false
                }
              }
            }
          ],
          "style": {
            "align": 1,
            "folded": false
          }
        },
        "parent_id": "TyZJdWsxtoGoBIxtYtic08dnnXe"
      },
      {
        "block_id": "FmtEdXaINoTUTIxSqixcBnzunrg",
        "block_type": 14,
        "code": {
          "elements": [
            {
              "text_run": {
                "content": "# 使用 AUTOINDEX 为 Collection 创建索引\nindex_params = {\n    'index_type': 'AUTOINDEX',\n    'metric_type': 'L2',\n    'params': {}\n}\ncollection.create_index(field_name=\"image_embedding\", index_params=index_params)\n",
                "text_element_style": {
                  "bold": false,
                  "inline_code": false,
                  "italic": false,
                  "strikethrough": false,
                  "underline": false
                }
              }
            },
            {
              "text_run": {
                "content": "collection.load()",
                "text_element_style": {
                  "bold": false,
                  "inline_code": false,
                  "italic": false,
                  "strikethrough": false,
                  "underline": false
                }
              }
            }
          ],
          "style": {
            "language": 49,
            "wrap": false
          }
        },
        "parent_id": "J3g9dc9gMovOqpxfMOCc6kVUnfg"
      },
      {
        "block_id": "Mj1tdQyoeotTIwxcWXOcDUmQnGd",
        "block_type": 2,
        "parent_id": "TyZJdWsxtoGoBIxtYtic08dnnXe",
        "text": {
          "elements": [
            {
              "text_run": {
                "content": "在完成上述步骤后，我们就可以向 Collection 中插入数据了。在创建索引文件后插入的任何数据都会被自动索引并可被立即用于搜索。如果数据正在索引过程中，Zilliz Cloud 会使用暴力搜索模式，所以搜索过程可能会比较慢。",
                "text_element_style": {
                  "bold": false,
                  "inline_code": false,
                  "italic": false,
                  "strikethrough": false,
                  "underline": false
                }
              }
            }
          ],
          "style": {
            "align": 1,
            "folded": false
          }
        }
      },
      {
        "block_id": "MhlMdZuB1oPHB1xK6uIc5xELnjc",
        "block_type": 4,
        "heading2": {
          "elements": [
            {
              "text_run": {
                "content": "插入数据",
                "text_element_style": {
                  "bold": false,
                  "inline_code": false,
                  "italic": false,
                  "strikethrough": false,
                  "underline": false
                }
              }
            },
            {
              "text_run": {
                "content": "{#insert-data}",
                "text_element_style": {
                  "bold": false,
                  "inline_code": false,
                  "italic": false,
                  "strikethrough": false,
                  "underline": false
                }
              }
            }
          ],
          "style": {
            "align": 1,
            "folded": false
          }
        },
        "parent_id": "TyZJdWsxtoGoBIxtYtic08dnnXe"
      },
      {
        "block_id": "V1CDdmGELovmwJxIjmxccrUxnRh",
        "block_type": 2,
        "parent_id": "TyZJdWsxtoGoBIxtYtic08dnnXe",
        "text": {
          "elements": [
            {
              "text_run": {
                "content": "在本示例中，我们将使用 SentenceTransformers 的 MiniLLM 模型为电影的情节文本生成对应的向量表示。该模型返回 384维的向量。",
                "text_element_style": {
                  "bold": false,
                  "inline_code": false,
                  "italic": false,
                  "strikethrough": false,
                  "underline": false
                }
              }
            }
          ],
          "style": {
            "align": 1,
            "folded": false
          }
        }
      },
      {
        "block_id": "IJCMduEPuoBZTdxmRdWc7felnFe",
        "block_type": 2,
        "parent_id": "TyZJdWsxtoGoBIxtYtic08dnnXe",
        "text": {
          "elements": [
            {
              "text_run": {
                "content": "在接下来的步骤中，我们将",
                "text_element_style": {
                  "bold": false,
                  "inline_code": false,
                  "italic": false,
                  "strikethrough": false,
                  "underline": false
                }
              }
            }
          ],
          "style": {
            "align": 1,
            "folded": false
          }
        }
      },
      {
        "block_id": "NrmqdpV5oou4NdxG3KacCcVZnJd",
        "block_type": 12,
        "bullet": {
          "elements": [
            {
              "text_run": {
                "content": "加载数据。",
                "text_element_style": {
                  "bold": false,
                  "inline_code": false,
                  "italic": false,
                  "strikethrough": false,
                  "underline": false
                }
              }
            }
          ],
          "style": {
            "align": 1,
            "folded": false
          }
        },
        "parent_id": "TyZJdWsxtoGoBIxtYtic08dnnXe"
      },
      {
        "block_id": "AJecd3EyioYJIzxmLa4cO7EjnW4",
        "block_type": 12,
        "bullet": {
          "elements": [
            {
              "text_run": {
                "content": "使用 SentenceTransformers 为电影的情节文本生成对应的向量表示。",
                "text_element_style": {
                  "bold": false,
                  "inline_code": false,
                  "italic": false,
                  "strikethrough": false,
                  "underline": false
                }
              }
            }
          ],
          "style": {
            "align": 1,
            "folded": false
          }
        },
        "parent_id": "TyZJdWsxtoGoBIxtYtic08dnnXe"
      },
      {
        "block_id": "LJEbdGGIVoSQsgxGr7FcV5rknsh",
        "block_type": 12,
        "bullet": {
          "elements": [
            {
              "text_run": {
                "content": "将数据插入到 Zilliz Cloud。",
                "text_element_style": {
                  "bold": false,
                  "inline_code": false,
                  "italic": false,
                  "strikethrough": false,
                  "underline": false
                }
              }
            }
          ],
          "style": {
            "align": 1,
            "folded": false
          }
        },
        "parent_id": "TyZJdWsxtoGoBIxtYtic08dnnXe"
      },
      {
        "block_id": "WALqdxJlKod2v1xN77ecO9hYnFf",
        "block_type": 14,
        "code": {
          "elements": [
            {
              "text_run": {
                "content": "import csv\nfrom sentence_transformers import SentenceTransformer\n\ntransformer = SentenceTransformer('all-MiniLM-L6-v2')\n\n# 抽取电影标题\ndef csv_load(file):\n    with open(file, newline='') as f:\n        reader = csv.reader(f, delimiter=',')\n        for row in reader:\n            if '' in (row[1], row[7]):\n                continue\n            yield (row[1], row[7])\n\n\n# 使用 SentenceTransformer 生成对应的向量表示\ndef embed_insert(data):\n    embeds = transformer.encode(data[1])\n    ins = [\n            data[0],\n            [x for x in embeds]\n    ]\n    collection.insert(ins)\n\nimport time\n\ndata_batch = [[],[]]\n\nfor title, plot in csv_load('./movies/plots.csv'):\n    data_batch[0].append(title)\n    data_batch[1].append(plot)\n    if len(data_batch[0]) % BATCH_SIZE == 0:\n        embed_insert(data_batch)\n        data_batch = [[],[]]\n\n# 为剩余数据生成对应的向量表示并存入数据库。\nif len(data_batch[0]) != 0:\n    embed_insert(data_batch)\n\n# 调用写入方法，让 Zilliz Cloud 自动索引数据。\n",
                "text_element_style": {
                  "bold": false,
                  "inline_code": false,
                  "italic": false,
                  "strikethrough": false,
                  "underline": false
                }
              }
            },
            {
              "text_run": {
                "content": "collection.flush()",
                "text_element_style": {
                  "bold": false,
                  "inline_code": false,
                  "italic": false,
                  "strikethrough": false,
                  "underline": false
                }
              }
            }
          ],
          "style": {
            "language": 49,
            "wrap": false
          }
        },
        "parent_id": "TyZJdWsxtoGoBIxtYtic08dnnXe"
      },
      {
        "block_id": "CHwvdHZX8oJyaBxvbG5cGOrCnjb",
        "block_type": 4,
        "heading2": {
          "elements": [
            {
              "text_run": {
                "content": "执行搜索",
                "text_element_style": {
                  "bold": false,
                  "inline_code": false,
                  "italic": false,
                  "strikethrough": false,
                  "underline": false
                }
              }
            },
            {
              "text_run": {
                "content": "{#perform-the-search}",
                "text_element_style": {
                  "bold": false,
                  "inline_code": false,
                  "italic": false,
                  "strikethrough": false,
                  "underline": false
                }
              }
            }
          ],
          "style": {
            "align": 1,
            "folded": false
          }
        },
        "parent_id": "TyZJdWsxtoGoBIxtYtic08dnnXe"
      },
      {
        "block_id": "HQH9dlBUco6uH3xgpxPczhVbnVd",
        "block_type": 2,
        "parent_id": "TyZJdWsxtoGoBIxtYtic08dnnXe",
        "text": {
          "elements": [
            {
              "text_run": {
                "content": "在向 Zilliz Cloud 插入所有数据后，我们就可以开始执行搜索了。在本示例中，我们将根据电影情节进行电影检索。由于代码中执行的是批量搜索，因此搜索时间是指完成同一批次中所有电影情节的相似性搜索的时间。",
                "text_element_style": {
                  "bold": false,
                  "inline_code": false,
                  "italic": false,
                  "strikethrough": false,
                  "underline": false
                }
              }
            }
          ],
          "style": {
            "align": 1,
            "folded": false
          }
        }
      },
      {
        "block_id": "JoKOdcHZyo7qpBx0VEgccBxmnBf",
        "block_type": 14,
        "code": {
          "elements": [
            {
              "text_run": {
                "content": "# 搜索与关键词最相近的标题\nsearch_terms = ['A movie about cars', 'A movie about monsters']\n\n# 在数据库中对输入文本进行相似性搜索的函数\ndef embed_search(data):\n    embeds = transformer.encode(data)\n    return [x for x in embeds]\n\nsearch_data = embed_search(search_terms)\n\nstart = time.time()\nres = collection.search(\n    data=search_data,  # 输入文本对应的向量表示\n    anns_field=\"embedding\",  # 在 embedding 字段中进行相似性搜索\n    param={},\n    limit = TOP_K,  # 每次搜索返回的结果数量\n    output_fields=['title']  # 在返回的结果中需要包含 title 字段\n)\nend = time.time()\n\nfor hits_i, hits in enumerate(res):\n    print('Title:', search_terms[hits_i])\n    print('Search Time:', end-start)\n    print('Results:')\n    for hit in hits:\n        print( hit.entity.get('title'), '----', hit.distance)\n",
                "text_element_style": {
                  "bold": false,
                  "inline_code": false,
                  "italic": false,
                  "strikethrough": false,
                  "underline": false
                }
              }
            },
            {
              "text_run": {
                "content": "    print()",
                "text_element_style": {
                  "bold": false,
                  "inline_code": false,
                  "italic": false,
                  "strikethrough": false,
                  "underline": false
                }
              }
            }
          ],
          "style": {
            "language": 49,
            "wrap": false
          }
        },
        "parent_id": "TyZJdWsxtoGoBIxtYtic08dnnXe"
      },
      {
        "block_id": "BILRdxjyGoE8rnxYnzvcPWlwnjf",
        "block_type": 2,
        "parent_id": "TyZJdWsxtoGoBIxtYtic08dnnXe",
        "text": {
          "elements": [
            {
              "text_run": {
                "content": "输出的结果与如下类似。",
                "text_element_style": {
                  "bold": false,
                  "inline_code": false,
                  "italic": false,
                  "strikethrough": false,
                  "underline": false
                }
              }
            }
          ],
          "style": {
            "align": 1,
            "folded": false
          }
        }
      },
      {
        "block_id": "FywNdcZgqo3YVnx5O16c4u1Enwc",
        "block_type": 14,
        "code": {
          "elements": [
            {
              "text_run": {
                "content": "Title: A movie about cars\nSearch Time: 0.04272913932800293\nResults:\nRed Line 7000 ---- 0.9104408621788025\nThe Mysterious Mr. Valentine ---- 0.9127437472343445\nTomboy ---- 0.9254708290100098\n\nTitle: A movie about monsters\nSearch Time: 0.04272913932800293\nResults:\nMonster Hunt ---- 0.8105474710464478\nThe Astro-Zombies ---- 0.8998500108718872\n",
                "text_element_style": {
                  "bold": false,
                  "inline_code": false,
                  "italic": false,
                  "strikethrough": false,
                  "underline": false
                }
              }
            },
            {
              "text_run": {
                "content": "Wild Country ---- 0.9238440990447998",
                "text_element_style": {
                  "bold": false,
                  "inline_code": false,
                  "italic": false,
                  "strikethrough": false,
                  "underline": false
                }
              }
            }
          ],
          "style": {
            "language": 49,
            "wrap": false
          }
        },
        "parent_id": "TyZJdWsxtoGoBIxtYtic08dnnXe"
      }
    ],
    "counts": 35
  }
}