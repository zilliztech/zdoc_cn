"use strict";(self.webpackChunksite=self.webpackChunksite||[]).push([[2898],{9319:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>p,contentTitle:()=>c,default:()=>g,frontMatter:()=>o,metadata:()=>d,toc:()=>u});var a=t(7462),i=(t(7294),t(3905)),r=t(3612),s=t(4866),l=t(5162);const o={slug:"/docs/conduct-a-range-search",beta:!0,notebook:"11_conduct_a_range_search.ipynb",sidebar_position:2},c="\u8303\u56f4\u641c\u7d22",d={unversionedId:"tutorials/collection/search-and-query/conduct-a-range-search",id:"tutorials/collection/search-and-query/conduct-a-range-search",title:"\u8303\u56f4\u641c\u7d22",description:"\u4e86\u89e3\u5982\u4f55\u6839\u636e Entity \u7684\u76f8\u4f3c\u7a0b\u5ea6\u6765\u7b5b\u9009\u5411\u91cf\u641c\u7d22\u7ed3\u679c\u81f3\u5173\u91cd\u8981\u3002\u901a\u8fc7\u9650\u5236\u67e5\u8be2\u5411\u91cf\u4e0e\u5176\u4ed6\u5411\u91cf\u4e4b\u95f4\u7684\u8ddd\u79bb\uff0c\u8303\u56f4\u641c\u7d22\u80fd\u591f\u5b9e\u73b0\u5bf9\u641c\u7d22\u7ed3\u679c\u7684\u6709\u6548\u7ec6\u5316\u3002",source:"@site/docs/tutorials/collection/search-and-query/conduct-a-range-search.md",sourceDirName:"tutorials/collection/search-and-query",slug:"/docs/conduct-a-range-search",permalink:"/docs/conduct-a-range-search",draft:!1,tags:[],version:"current",sidebarPosition:2,frontMatter:{slug:"/docs/conduct-a-range-search",beta:!0,notebook:"11_conduct_a_range_search.ipynb",sidebar_position:2},sidebar:"tutorialSidebar",previous:{title:"\u5411\u91cf\u641c\u7d22\u548c\u67e5\u8be2",permalink:"/docs/search-query-and-get"},next:{title:"\u4f7f\u7528\u8fed\u4ee3\u5668\u641c\u7d22\u548c\u67e5\u8be2",permalink:"/docs/search-and-query-iterators"}},p={},u=[{value:"\u5f00\u59cb\u524d",id:"before-you-start",level:2},{value:"\u6b65\u9aa4\u7b80\u4ecb",id:"quick-steps-for-a-range-search",level:2},{value:"\u6b65\u9aa4 1\uff1a\u52a0\u8f7d Collection \u4e0e\u63d2\u5165\u6570\u636e",id:"step-1-load-collection-and-insert-data",level:2},{value:"\u6b65\u9aa4 2\uff1a\u8bbe\u7f6e\u8303\u56f4\u8fc7\u6ee4",id:"step-2-configure-range-filtering",level:2},{value:"\u8ddd\u79bb\u5ea6\u91cf\u7684\u5f71\u54cd",id:"distance-metrics-influence",level:3},{value:"\u6b65\u9aa4 3\uff1a\u6267\u884c\u8303\u56f4\u641c\u7d22",id:"step-3-execute-the-range-search",level:2},{value:"\u8981\u70b9\u603b\u7ed3",id:"takeaways",level:2},{value:"\u76f8\u5173\u6587\u6863",id:"related-topics",level:2}],m={toc:u},h="wrapper";function g(e){let{components:n,...t}=e;return(0,i.kt)(h,(0,a.Z)({},m,t,{components:n,mdxType:"MDXLayout"}),(0,i.kt)("h1",{id:"\u8303\u56f4\u641c\u7d22"},"\u8303\u56f4\u641c\u7d22"),(0,i.kt)("p",null,"\u4e86\u89e3\u5982\u4f55\u6839\u636e Entity \u7684\u76f8\u4f3c\u7a0b\u5ea6\u6765\u7b5b\u9009\u5411\u91cf\u641c\u7d22\u7ed3\u679c\u81f3\u5173\u91cd\u8981\u3002\u901a\u8fc7\u9650\u5236\u67e5\u8be2\u5411\u91cf\u4e0e\u5176\u4ed6\u5411\u91cf\u4e4b\u95f4\u7684\u8ddd\u79bb\uff0c\u8303\u56f4\u641c\u7d22\u80fd\u591f\u5b9e\u73b0\u5bf9\u641c\u7d22\u7ed3\u679c\u7684\u6709\u6548\u7ec6\u5316\u3002"),(0,i.kt)("p",null,"\u672c\u6307\u5357\u4ecb\u7ecd\u5982\u4f55\u5728 Zilliz Cloud \u4e2d\u6267\u884c\u8303\u56f4\u641c\u7d22\u3002\u5728\u6574\u4e2a\u8303\u56f4\u641c\u7d22\u6d41\u7a0b\u4e2d\uff0cZilliz Cloud \u9996\u5148\u57fa\u4e8e\u5411\u91cf\u4e4b\u95f4\u7684\u76f8\u4f3c\u6027\u8fdb\u884c\u641c\u7d22\uff0c\u968f\u540e\u901a\u8fc7\u6307\u5b9a\u7684\u5411\u91cf\u8ddd\u79bb\u8fdb\u884c\u8fc7\u6ee4\uff0c\u4ee5\u786e\u4fdd\u6700\u7ec8\u83b7\u5f97\u7684\u5411\u91cf\u7ed3\u679c\u4f4d\u4e8e\u8bbe\u5b9a\u7684\u8ddd\u79bb\u8303\u56f4\u5185\u3002"),(0,i.kt)(r.Z,{type:"info",icon:"\ud83d\udcd8",title:"\u8bf4\u660e",mdxType:"Admonition"},(0,i.kt)("p",null,"\u76ee\u524d\uff0c\u8303\u56f4\u641c\u7d22\u529f\u80fd\u5904\u4e8e Beta \u6d4b\u8bd5\u9636\u6bb5\u3002\u8bf7\u6ce8\u610f\uff0c\u8be5\u529f\u80fd\u53ca\u76f8\u5173\u6587\u6863\u5728 Beta \u6d4b\u8bd5\u671f\u95f4\u53ef\u80fd\u4f1a\u6709\u6240\u66f4\u6539\u3002")),(0,i.kt)("h2",{id:"before-you-start"},"\u5f00\u59cb\u524d"),(0,i.kt)("p",null,"\u5728\u6267\u884c\u8303\u56f4\u641c\u7d22\u524d\uff0c\u8bf7\u786e\u4fdd\u4ee5\u4e0b\u51e0\u70b9\uff1a"),(0,i.kt)("p",null,"[Unsupported block type]"),(0,i.kt)("p",null,"[Unsupported block type]"),(0,i.kt)("h2",{id:"quick-steps-for-a-range-search"},"\u6b65\u9aa4\u7b80\u4ecb"),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"\u52a0\u8f7d Collection \u4e0e\u63d2\u5165\u6570\u636e\uff1a\u9996\u5148\u786e\u4fdd\u60a8\u7684 Collection \u5df2\u52a0\u8f7d\uff0c\u5e76\u4e14\u6570\u636e\u5df2\u63d2\u5165\u81f3 Collection\u3002")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"\u8bbe\u7f6e\u8303\u56f4\u8fc7\u6ee4\uff1a\u5b9a\u4e49 ",(0,i.kt)("inlineCode",{parentName:"p"},"radius")," \u548c ",(0,i.kt)("inlineCode",{parentName:"p"},"range_filter")," \u53c2\u6570\uff0c\u4ee5\u63a7\u5236\u641c\u7d22\u7cbe\u51c6\u5ea6\u3002Zilliz Cloud \u652f\u6301\u4f7f\u7528 ",(0,i.kt)("strong",{parentName:"p"},"L2"),"\uff08\u6b27\u51e0\u91cc\u5f97\u8ddd\u79bb\uff09\u548c ",(0,i.kt)("strong",{parentName:"p"},"IP"),"\uff08\u5185\u79ef\uff09\u4f5c\u4e3a\u8ddd\u79bb\u6d4b\u91cf\u7684\u5ea6\u91cf\u7c7b\u578b\u3002",(0,i.kt)("inlineCode",{parentName:"p"},"radius")," \u548c ",(0,i.kt)("inlineCode",{parentName:"p"},"range_filter")," \u7684\u8bbe\u7f6e\u5c06\u53d7\u5230\u9009\u7528\u7684\u8ddd\u79bb\u6d4b\u91cf\u5ea6\u91cf\u7c7b\u578b\u7684\u5f71\u54cd\u3002")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"\u6267\u884c\u641c\u7d22\uff1a\u6839\u636e\u6b65\u9aa4 2 \u8bbe\u7f6e\u7684\u53c2\u6570\u8fdb\u884c\u8303\u56f4\u641c\u7d22\u3002\u60a8\u5c06\u5f97\u5230\u7684\u5411\u91cf\u7ed3\u679c\u4f1a\u4f4d\u4e8e\u6307\u5b9a\u7684\u8303\u56f4\u5185\uff0c\u7b26\u5408\u60a8\u9009\u62e9\u7684\u8ddd\u79bb\u5ea6\u91cf\u6807\u51c6\u3002"))),(0,i.kt)(r.Z,{type:"info",icon:"\ud83d\udcd8",title:"\u8bf4\u660e",mdxType:"Admonition"},(0,i.kt)("p",null,"\u6b64\u5904\u7684\u4ee3\u7801\u793a\u4f8b\u9ed8\u8ba4\u60a8\u5df2\u6309\u7167",(0,i.kt)("a",{parentName:"p",href:"./create-collection"},"\u521b\u5efa Collection")," \u7684\u6b65\u9aa4\u5b8c\u6210 Collection \u7684\u521b\u5efa\u548c\u6570\u636e\u63d2\u5165\u3002")),(0,i.kt)("h2",{id:"step-1-load-collection-and-insert-data"},"\u6b65\u9aa4 1\uff1a\u52a0\u8f7d Collection \u4e0e\u63d2\u5165\u6570\u636e"),(0,i.kt)("p",null,"\u5f00\u59cb\u524d\uff0c\u8bf7\u786e\u4fdd Collection \u5df2\u88ab\u52a0\u8f7d\u81f3\u5185\u5b58\uff0c\u56e0 Zilliz Cloud \u7684\u641c\u7d22\u548c\u67e5\u8be2\u529f\u80fd\u5728\u5185\u5b58\u4e2d\u6267\u884c\u3002"),(0,i.kt)(s.Z,{groupId:"code",defaultValue:"python",values:[{label:"Python",value:"python"},{label:"NodeJS",value:"javascript"},{label:"Java",value:"java"}],mdxType:"Tabs"},(0,i.kt)(l.Z,{value:"python",mdxType:"TabItem"},(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-python"},'from pymilvus import Collection\n\nDATASET_PATH="{}/../medium_articles_2020_dpr.json".format(os.path.dirname(__file__)) # Set your dataset path\n\n# (Continued)\n\ncollection = Collection(COLLECTION_NAME)\n\n# Load collection\ncollection.load()\n\n# Get loading progress\nprogress = utility.loading_progress(COLLECTION_NAME)\n\nprint(progress)\n\n# Output\n#\n# {\n#     "loading_progress": "100%"\n# }\n\n# Prepare a list of rows\nwith open(DATASET_PATH) as f:\n    data = json.load(f)\n    rows = data[\'rows\']\n\nprint(rows[:3])\n\n# Output\n#\n# [\n#     {\n#         "id": 0,\n#         "title": "The Reported Mortality Rate of Coronavirus Is Not Important",\n#         "title_vector": [\n#             0.041732933,\n#             0.013779674,\n#             -0.027564144,\n#             -0.013061441,\n#             0.009748648,\n#             0.00082446384,\n#             -0.00071647146,\n#             0.048612226,\n#             -0.04836573,\n#             -0.04567751,\n#             "(758 more items hidden)"\n#         ],\n#         "link": "https://medium.com/swlh/the-reported-mortality-rate-of-coronavirus-is-not-important-369989c8d912",\n#         "reading_time": 13,\n#         "publication": "The Startup",\n#         "claps": 1100,\n#         "responses": 18\n#     },\n#     {\n#         "id": 1,\n#         "title": "Dashboards in Python: 3 Advanced Examples for Dash Beginners and Everyone Else",\n#         "title_vector": [\n#             0.0039737443,\n#             0.003020432,\n#             -0.0006188639,\n#             0.03913546,\n#             -0.00089768134,\n#             0.021238148,\n#             0.014454661,\n#             0.025742851,\n#             0.0022063442,\n#             -0.051130578,\n#             "(758 more items hidden)"\n#         ],\n#         "link": "https://medium.com/swlh/dashboards-in-python-3-advanced-examples-for-dash-beginners-and-everyone-else-b1daf4e2ec0a",\n#         "reading_time": 14,\n#         "publication": "The Startup",\n#         "claps": 726,\n#         "responses": 3\n#     },\n#     {\n#         "id": 2,\n#         "title": "How Can We Best Switch in Python?",\n#         "title_vector": [\n#             0.031961977,\n#             0.00047043373,\n#             -0.018263113,\n#             0.027324716,\n#             -0.0054595284,\n#             -0.014779159,\n#             0.017511465,\n#             0.030381083,\n#             -0.018930407,\n#             -0.03372473,\n#             "(758 more items hidden)"\n#         ],\n#         "link": "https://medium.com/swlh/how-can-we-best-switch-in-python-458fb33f7835",\n#         "reading_time": 6,\n#         "publication": "The Startup",\n#         "claps": 500,\n#         "responses": 7\n#     }\n# ]\n\n# Insert data\nresults = collection.insert(rows)\n\nprint(f"Data inserted successfully! inserted rows: {results.insert_count}")\n\n# Output\n#\n# Data inserted successfully! inserted rows: 5979\n\ntime.sleep(10)\n'))),(0,i.kt)(l.Z,{value:"javascript",mdxType:"TabItem"},(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-javascript"},"import { MilvusClient } from \"@zilliz/milvus2-sdk-node\";\nconst data_file = `./medium_articles_2020_dpr.json`\nconst collectionName = \"medium_articles_2020\"\n\nasync function main() {\n    // (Continued)\n    \n    res = await client.loadCollection({\n        collection_name: collectionName\n    });\n    \n    console.log(res);\n    \n    // Output\n    // { error_code: 'Success', reason: '' }\n    \n    res = await client.getLoadingProgress({\n        collection_name: collectionName\n    });\n    \n    console.log(res);\n    \n    // Output:\n    // { status: { error_code: 'Success', reason: '' }, progress: '100' }\n}\n\n// 5. Insert vectors\nconst data = JSON.parse(fs.readFileSync(data_file, \"utf8\"))\n\n// read rows\nconst rows = data[\"rows\"]\nconst row = rows[0]\n\nconsole.log(Object.keys(row))\n\n// Output\n// \n// [\n//   'id',\n//   'title',\n//   'title_vector',\n//   'link',\n//   'reading_time',\n//   'publication',\n//   'claps',\n//   'responses'\n// ]\n// \n\n//insert vectors\nres = await client.insert({\n    collection_name: collectionName,\n    data: rows\n})\n\nconsole.log(res)\n\n// Output\n// \n// {\n//   succ_index: [\n//      0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11,\n//     12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23,\n//     24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35,\n//     36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47,\n//     48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59,\n//     60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71,\n//     72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83,\n//     84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95,\n//     96, 97, 98, 99,\n//     ... 5879 more items\n//   ],\n//   err_index: [],\n//   status: { error_code: 'Success', reason: '', code: 0 },\n//   IDs: { int_id: { data: [Array] }, id_field: 'int_id' },\n//   acknowledged: false,\n//   insert_cnt: '5979',\n//   delete_cnt: '0',\n//   upsert_cnt: '0',\n//   timestamp: '445332879628304386'\n// }\n// \n\nawait sleep(5000)\n"))),(0,i.kt)(l.Z,{value:"java",mdxType:"TabItem"},(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},'import io.milvus.param.LoadCollectionParam;\n\n// (Continued)\n\n// Load collection\n\nLoadCollectionParam loadCollectionParam = LoadCollectionParam.newBuilder()\n.withCollectionName(collectionName)\n.build();\n\nR<RpcStatus> loadCollectionRes = client.loadCollection(loadCollectionParam);\n\nif (loadCollectionRes.getException() != null) {\nSystem.err.println("Failed to load collection: " + loadCollectionRes.getException().getMessage());\nreturn;\n}\n\nSystem.out.println("Collection loaded!");\n\n// Output:\n// Collection loaded!\n\n// 6. Insert vectors\n\nString content;\n\n// read a local file\nPath file = Path.of(data_file);\ntry {\n    content = Files.readString(file);\n} catch (Exception e) {\n    System.err.println("Failed to read file: " + e.getMessage());\n    return;\n}\n\nSystem.out.println("Successfully read file");\n\n// Output:\n// Successfully read file\n\n// Load dataset\nJSONObject dataset = JSON.parseObject(content);\nList<JSONObject> rows = getRows(dataset.getJSONArray("rows"), 5979);\nList<Field> fields = getFields(dataset.getJSONArray("rows"), 5979);\n\nInsertParam insertParam = InsertParam.newBuilder()\n    .withCollectionName(collectionName)\n    .withFields(fields)\n    .build();\n\nR<MutationResult> insertResponse = client.insert(insertParam);\n\nif (insertResponse.getStatus() != R.Status.Success.getCode()) {\n    System.err.println(insertResponse.getMessage());\n}\n\nMutationResultWrapper mutationResultWrapper = new MutationResultWrapper(insertResponse.getData());\n\nSystem.out.println("Successfully insert entities: " + mutationResultWrapper.getInsertCount());   \n\n// Output:\n// Successfully insert entities: 5979\n\n// wait for a while\ntry {\n    // pause execution for 5 seconds\n    Thread.sleep(5000);\n} catch (InterruptedException e) {\n    // handle the exception\n    Thread.currentThread().interrupt();\n}  \n')))),(0,i.kt)("h2",{id:"step-2-configure-range-filtering"},"\u6b65\u9aa4 2\uff1a\u8bbe\u7f6e\u8303\u56f4\u8fc7\u6ee4"),(0,i.kt)("p",null,"\u4f7f\u7528 Zilliz Cloud \u8fdb\u884c\u8303\u56f4\u641c\u7d22\u65f6\uff0c\u6709\u4e24\u4e2a\u5173\u952e\u53c2\u6570\u4e0e\u6807\u51c6\u5411\u91cf\u641c\u7d22\u4e0d\u540c\uff1a"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("inlineCode",{parentName:"p"},"radius"),"\uff1a\u8bbe\u5b9a\u76f8\u4f3c\u6027\u7684\u6700\u4f4e\u9608\u503c\u3002")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("inlineCode",{parentName:"p"},"range_filter"),"\uff1a\u53ef\u9009\u53c2\u6570\uff0c\u8fdb\u4e00\u6b65\u7ec6\u5316\u641c\u7d22\u8303\u56f4\uff0c\u9650\u5b9a\u5728\u7279\u5b9a\u7684\u76f8\u4f3c\u6027\u533a\u95f4\u5185\u3002"))),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"radius")," \u548c ",(0,i.kt)("inlineCode",{parentName:"p"},"range_filter")," \u53c2\u6570\u5747\u4e3a ",(0,i.kt)("strong",{parentName:"p"},"FLOAT")," \u7c7b\u578b\uff0c\u5b83\u4eec\u5728\u4fdd\u8bc1\u641c\u7d22\u51c6\u786e\u6027\u4e0e\u6548\u7387\u4e4b\u95f4\u8d77\u7740\u5e73\u8861\u4f5c\u7528\u3002"),(0,i.kt)("h3",{id:"distance-metrics-influence"},"\u8ddd\u79bb\u5ea6\u91cf\u7684\u5f71\u54cd"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("strong",{parentName:"p"},"L2")," \u8ddd\u79bb\uff1a\u7b5b\u9009\u51fa\u8ddd\u79bb\u5c0f\u4e8e ",(0,i.kt)("inlineCode",{parentName:"p"},"radius")," \u7684\u5411\u91cf\uff0c\u56e0\u4e3a\u8f83\u77ed\u7684 ",(0,i.kt)("strong",{parentName:"p"},"L2")," \u8ddd\u79bb\u4ee3\u8868\u66f4\u9ad8\u7684\u76f8\u4f3c\u6027\u3002\u82e5\u60f3\u6392\u9664\u7ed3\u679c\u4e2d\u6700\u63a5\u8fd1\u7684\u5411\u91cf\uff0c\u53ef\u5c06 ",(0,i.kt)("inlineCode",{parentName:"p"},"range_filter")," \u8bbe\u5b9a\u4e3a\u4f4e\u4e8e ",(0,i.kt)("inlineCode",{parentName:"p"},"radius")," \u7684\u503c\u3002"),(0,i.kt)(s.Z,{groupId:"code",defaultValue:"python",values:[{label:"Python",value:"python"},{label:"NodeJS",value:"javascript"},{label:"Java",value:"java"}],mdxType:"Tabs"},(0,i.kt)(l.Z,{value:"python",mdxType:"TabItem"},(0,i.kt)("pre",{parentName:"li"},(0,i.kt)("code",{parentName:"pre",className:"language-python"},'# Define search parameters\nsearch_params = {\n    "metric_type": "L2",\n    "params": {\n        "nprobe": 10,\n        "radius": 1.0,\n        "range_filter": 0.8\n    }\n}\n'))),(0,i.kt)(l.Z,{value:"javascript",mdxType:"TabItem"},(0,i.kt)("pre",{parentName:"li"},(0,i.kt)("code",{parentName:"pre",className:"language-javascript"},"const params = {\n    nprobe: 10,\n    radius: 1.0,\n    range_filter: 0.8\n}\n"))),(0,i.kt)(l.Z,{value:"java",mdxType:"TabItem"},(0,i.kt)("pre",{parentName:"li"},(0,i.kt)("code",{parentName:"pre",className:"language-java"},'params = "{\\"nprobe\\": 10, \\"radius\\": 1.0, \\"range_filter\\": 0.8}"\n'))))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("strong",{parentName:"p"},"IP")," \u8ddd\u79bb\uff1a\u7b5b\u9009\u51fa\u8ddd\u79bb\u5927\u4e8e ",(0,i.kt)("inlineCode",{parentName:"p"},"radius")," \u7684\u5411\u91cf\uff0c\u56e0\u4e3a\u66f4\u5927\u7684 ",(0,i.kt)("strong",{parentName:"p"},"IP")," \u8ddd\u79bb\u610f\u5473\u7740\u66f4\u9ad8\u7684\u76f8\u4f3c\u6027\u3002\u5728\u6b64\u60c5\u51b5\u4e0b\uff0c\u5e94\u5c06 ",(0,i.kt)("inlineCode",{parentName:"p"},"range_filter")," \u8bbe\u5b9a\u4e3a\u9ad8\u4e8e ",(0,i.kt)("inlineCode",{parentName:"p"},"radius")," \u7684\u503c\uff0c\u4ee5\u6392\u9664\u6700\u76f8\u4f3c\u7684\u5411\u91cf\u3002"),(0,i.kt)(s.Z,{groupId:"code",defaultValue:"python",values:[{label:"Python",value:"python"},{label:"NodeJS",value:"javascript"},{label:"Java",value:"java"}],mdxType:"Tabs"},(0,i.kt)(l.Z,{value:"python",mdxType:"TabItem"},(0,i.kt)("pre",{parentName:"li"},(0,i.kt)("code",{parentName:"pre",className:"language-python"},'# Define search parameters\n# When metric_type is set to IP,\n# `radius` and `range_filter` are reversed compared to `L2` metric\n\nsearch_params = {\n    "metric_type": "IP",\n    "params": {\n        "nprobe": 10,\n        "radius": 0.8,\n        "range_filter": 1.0\n    }\n}\n'))),(0,i.kt)(l.Z,{value:"javascript",mdxType:"TabItem"},(0,i.kt)("pre",{parentName:"li"},(0,i.kt)("code",{parentName:"pre",className:"language-javascript"},"// Define search parameters\n// When metric_type is set to IP,\n// `radius` and `range_filter` are reversed compared to `L2` metric\n\nconst params = {\n    nprobe: 10,\n    radius: 0.8,\n    range_filter: 1.0\n}\n"))),(0,i.kt)(l.Z,{value:"java",mdxType:"TabItem"},(0,i.kt)("pre",{parentName:"li"},(0,i.kt)("code",{parentName:"pre",className:"language-java"},'params = "{\\"nprobe\\": 10, \\"radius\\": 0.8, \\"range_filter\\": 1.0}"\n')))))),(0,i.kt)("h2",{id:"step-3-execute-the-range-search"},"\u6b65\u9aa4 3\uff1a\u6267\u884c\u8303\u56f4\u641c\u7d22"),(0,i.kt)("p",null,"\u53c2\u6570\u8bbe\u7f6e\u5b8c\u6bd5\u540e\uff0c\u5f00\u59cb\u68c0\u7d22\u843d\u5728\u7279\u5b9a\u8303\u56f4\u5185\u7684\u5411\u91cf\uff1a"),(0,i.kt)(s.Z,{groupId:"code",defaultValue:"python",values:[{label:"Python",value:"python"},{label:"NodeJS",value:"javascript"},{label:"Java",value:"java"}],mdxType:"Tabs"},(0,i.kt)(l.Z,{value:"python",mdxType:"TabItem"},(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-python"},'# conduct a range search\nquery_vector = rows[0][\'title_vector\']\n\nres = collection.search(\n    data=[query_vector],\n    anns_field="title_vector",\n    param=search_params,\n    output_fields=["title", "link"],\n    limit=100,\n)\n\nids = [ hits.ids for hits in res ]\n\nprint(ids)\n\n# Output\n#\n# [\n#     [\n#         1846,\n#         2906,\n#         4411,\n#         3503,\n#         4397,\n#         4969,\n#         2705,\n#         3185,\n#         5532,\n#         1969,\n#         "(90 more items hidden)"\n#     ]\n# ]\n\ndistances = [ hits.distances for hits in res ]\n\nprint(distances)\n\n# Output\n#\n# [\n#     [\n#         0.8001112341880798,\n#         0.8001610040664673,\n#         0.8003642559051514,\n#         0.8004330992698669,\n#         0.8004655838012695,\n#         0.8004793524742126,\n#         0.8005216121673584,\n#         0.8005879521369934,\n#         0.8005922436714172,\n#         0.8007100224494934,\n#         "(90 more items hidden)"\n#     ]\n# ]\n\nresults = [ {\n    "id": hit.id,\n    "distance": hit.distance,\n    "entity": {\n        "title": hit.entity.get("title"),\n        "link": hit.entity.get("link"),\n    }\n} for hits in res for hit in hits ]\n\nprint(results)\n\n# Output\n#\n# [\n#     {\n#         "id": 1846,\n#         "distance": 0.8001112341880798,\n#         "entity": {\n#             "title": "Simple VSCode Setup To Develop C++",\n#             "link": "https://medium.com/swlh/simple-vscode-setup-to-develop-c-7830182ee4d8"\n#         }\n#     },\n#     {\n#         "id": 2906,\n#         "distance": 0.8001610040664673,\n#         "entity": {\n#             "title": "Binary cross-entropy and logistic regression",\n#             "link": "https://towardsdatascience.com/binary-cross-entropy-and-logistic-regression-bf7098e75559"\n#         }\n#     },\n#     {\n#         "id": 4411,\n#         "distance": 0.8003642559051514,\n#         "entity": {\n#             "title": "Why Passion Is Not Enough in the Working World \\u2014 Learn Professionalism Instead",\n#             "link": "https://medium.com/swlh/why-passion-is-not-enough-in-the-working-world-learn-professionalism-instead-d1bdb0acd750"\n#         }\n#     },\n#     {\n#         "id": 3503,\n#         "distance": 0.8004330992698669,\n#         "entity": {\n#             "title": "Figma to video prototyping \\u2014 easy way in 3 steps",\n#             "link": "https://uxdesign.cc/figma-to-video-prototyping-easy-way-in-3-steps-d7ac3770d253"\n#         }\n#     },\n#     {\n#         "id": 4397,\n#         "distance": 0.8004655838012695,\n#         "entity": {\n#             "title": "An Introduction to Survey Research",\n#             "link": "https://medium.com/swlh/an-introduction-to-survey-research-ba9e9fb9ca57"\n#         }\n#     },\n#     {\n#         "id": 4969,\n#         "distance": 0.8004793524742126,\n#         "entity": {\n#             "title": "Warning: Your campaign (process) is broken",\n#             "link": "https://medium.com/swlh/warning-your-campaign-process-is-broken-97f3c603f8aa"\n#         }\n#     },\n#     {\n#         "id": 2705,\n#         "distance": 0.8005216121673584,\n#         "entity": {\n#             "title": "Exploratory Data Analysis: DataPrep.eda vs Pandas-Profiling",\n#             "link": "https://towardsdatascience.com/exploratory-data-analysis-dataprep-eda-vs-pandas-profiling-7137683fe47f"\n#         }\n#     },\n#     {\n#         "id": 3185,\n#         "distance": 0.8005879521369934,\n#         "entity": {\n#             "title": "Modelling Volatile Time Series with LSTM Networks",\n#             "link": "https://towardsdatascience.com/modelling-volatile-time-series-with-lstm-networks-51250fb7cfa3"\n#         }\n#     },\n#     {\n#         "id": 5532,\n#         "distance": 0.8005922436714172,\n#         "entity": {\n#             "title": "Removing \\u2018The Wall\\u2019 in ML Ops",\n#             "link": "https://towardsdatascience.com/removing-the-wall-in-ml-ops-44dac377b4c6"\n#         }\n#     },\n#     {\n#         "id": 1969,\n#         "distance": 0.8007100224494934,\n#         "entity": {\n#             "title": "Base Plotting in R",\n#             "link": "https://towardsdatascience.com/base-plotting-in-r-eb365da06b22"\n#         }\n#     },\n#     "(90 more items hidden)"\n# ]\n'))),(0,i.kt)(l.Z,{value:"javascript",mdxType:"TabItem"},(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-javascript"},"// 6. Conduct a range search\n\nres = await client.search({\n    collection_name: collectionName,\n    vector: rows[0].title_vector,\n    limit: 100,\n    filter: \"claps > 30 and reading_time < 10\",\n    output_fields: [\"title\", \"link\"],\n    params: {\n        nprobe: 10,\n        radius: 1.0,\n        range_filter: 0.8\n    }\n});\n\n// Count the results\n\nconsole.log(res.results.length);\n\n// Output\n// \n// 100\n// \n\n// List first few results\n\nconsole.log(res.results.slice(0, 5));\n\n// Output\n// \n// [\n//   {\n//     score: 0.8003642559051514,\n//     id: '4411',\n//     title: 'Why Passion Is Not Enough in the Working World \u2014 Learn Professionalism Instead',\n//     link: 'https://medium.com/swlh/why-passion-is-not-enough-in-the-working-world-learn-professionalism-instead-d1bdb0acd750'\n//   },\n//   {\n//     score: 0.8004330992698669,\n//     id: '3503',\n//     title: 'Figma to video prototyping \u2014 easy way in 3 steps',\n//     link: 'https://uxdesign.cc/figma-to-video-prototyping-easy-way-in-3-steps-d7ac3770d253'\n//   },\n//   {\n//     score: 0.8004655838012695,\n//     id: '4397',\n//     title: 'An Introduction to Survey Research',\n//     link: 'https://medium.com/swlh/an-introduction-to-survey-research-ba9e9fb9ca57'\n//   },\n//   {\n//     score: 0.8005216121673584,\n//     id: '2705',\n//     title: 'Exploratory Data Analysis: DataPrep.eda vs Pandas-Profiling',\n//     link: 'https://towardsdatascience.com/exploratory-data-analysis-dataprep-eda-vs-pandas-profiling-7137683fe47f'\n//   },\n//   {\n//     score: 0.8005879521369934,\n//     id: '3185',\n//     title: 'Modelling Volatile Time Series with LSTM Networks',\n//     link: 'https://towardsdatascience.com/modelling-volatile-time-series-with-lstm-networks-51250fb7cfa3'\n//   }\n// ]\n// \n"))),(0,i.kt)(l.Z,{value:"java",mdxType:"TabItem"},(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},'// 7. Search vectors\n\nList<List<Float>> queryVectors = new ArrayList<>();\nList<Float> queryVector1 = rows.get(0).getJSONArray("title_vector").toJavaList(Float.class);\nqueryVectors.add(queryVector1);\n\nList<String> outputFields = new ArrayList<>();\noutputFields.add("title");\noutputFields.add("link");\n\n// Search vectors in a collection\n\nSearchParam searchParam = SearchParam.newBuilder()\n    .withCollectionName(collectionName)\n    .withVectorFieldName("title_vector")\n    .withVectors(queryVectors)\n    .withTopK(5)   \n    .withMetricType(MetricType.L2) \n    // Set the \'radius\' and \'range_filter\' here! \n    .withParams("{\\"nprobe\\":10,\\"radius\\":1.0, \\"range_filter\\":0.8}")\n    .withConsistencyLevel(ConsistencyLevelEnum.BOUNDED)\n    .withOutFields(outputFields)\n    .withExpr("(publication == \\"Towards Data Science\\") and ((claps > 1500 and responses > 15) or (10 < reading_time < 15))")\n    .build();\n\nR<SearchResults> response = client.search(searchParam);\n\nSearchResultsWrapper wrapper = new SearchResultsWrapper(response.getData().getResults());\n\nList<List<JSONObject>> results = new ArrayList<>();\n\nfor (int i = 0; i < queryVectors.size(); ++i) {\n    List<SearchResultsWrapper.IDScore> scores = wrapper.getIDScore(i);\n    List<JSONObject> entities = new ArrayList<>();\n    for (int j = 0; j < scores.size(); ++j) {\n        SearchResultsWrapper.IDScore score = scores.get(j);\n        JSONObject entity = new JSONObject(1, true);\n        entity.put("id", score.getLongID());\n        entity.put("distance", score.getScore());\n        entity.put("title", scores.get(j).get("title"));\n        entity.put("link", scores.get(j).get("link"));\n        entities.add(entity);\n    }\n    \n    results.add(entities);\n} \n\nSystem.out.println(results);\n\n// Output:\n// [[\n//     {\n//         "distance": 0.800161,\n//         "link": "https://towardsdatascience.com/binary-cross-entropy-and-logistic-regression-bf7098e75559",\n//         "id": 445494450042705136,\n//         "title": "Binary cross-entropy and logistic regression"\n//     },\n//     {\n//         "distance": 0.80130583,\n//         "link": "https://towardsdatascience.com/what-i-learnt-from-taking-a-masters-in-computer-vision-and-machine-learning-69f0c6dfe9df",\n//         "id": 445494450042703937,\n//         "title": "What I Learnt From Taking A Masters In Computer Vision And Machine Learning"\n//     },\n//     {\n//         "distance": 0.8042611,\n//         "link": "https://towardsdatascience.com/do-not-use-to-join-strings-in-python-f89908307273",\n//         "id": 445494450042703425,\n//         "title": "Do Not Use \\u201c+\\u201d to Join Strings in Python"\n//     },\n//     {\n//         "distance": 0.8053469,\n//         "link": "https://towardsdatascience.com/using-data-science-to-study-economic-inequality-in-the-united-states-1101e9350c3d",\n//         "id": 445494450042703983,\n//         "title": "Using Data Science to Study Economic Inequality in the United States"\n//     },\n//     {\n//         "distance": 0.80535966,\n//         "link": "https://towardsdatascience.com/learn-ai-today-01-getting-started-with-pytorch-2e3ba25a518",\n//         "id": 445494450042703567,\n//         "title": "Learn AI Today: 01 \\u2014 Getting started with Pytorch"\n//     }\n// ]]\n')))),(0,i.kt)("h2",{id:"takeaways"},"\u8981\u70b9\u603b\u7ed3"),(0,i.kt)("p",null,"\u6839\u636e\u60a8\u8bbe\u5b9a\u7684 ",(0,i.kt)("inlineCode",{parentName:"p"},"radius")," \u548c ",(0,i.kt)("inlineCode",{parentName:"p"},"range_filter"),"\uff0cZilliz Cloud \u4f1a\u8fd4\u56de\u7b26\u5408\u6307\u5b9a\u8303\u56f4\u7684\u5411\u91cf\u3002\u4ee5\u4e0b\u662f\u4e00\u4e2a\u5feb\u901f\u53c2\u8003\u8868\uff0c\u6982\u62ec\u4e86\u4e0d\u540c\u8ddd\u79bb\u5ea6\u91cf\u5982\u4f55\u5f71\u54cd\u8fd9\u4e9b\u8bbe\u7f6e\u3002"),(0,i.kt)("table",null,(0,i.kt)("thead",{parentName:"table"},(0,i.kt)("tr",{parentName:"thead"},(0,i.kt)("th",{parentName:"tr",align:null},"\u5ea6\u91cf\u7c7b\u578b"),(0,i.kt)("th",{parentName:"tr",align:null},"\u914d\u7f6e"))),(0,i.kt)("tbody",{parentName:"table"},(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("strong",{parentName:"td"},"L2")),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"range_filter")," <= distance < ",(0,i.kt)("inlineCode",{parentName:"td"},"radius"))),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("strong",{parentName:"td"},"IP")),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"radius")," < distance <= ",(0,i.kt)("inlineCode",{parentName:"td"},"range_filter"))))),(0,i.kt)("h2",{id:"related-topics"},"\u76f8\u5173\u6587\u6863"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("a",{parentName:"p",href:"./search-query-and-get"},"\u5411\u91cf\u641c\u7d22\u548c\u67e5\u8be2"))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("a",{parentName:"p",href:"./search-and-query-iterators"},"\u4f7f\u7528\u8fed\u4ee3\u5668\u641c\u7d22\u548c\u67e5\u8be2"))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("a",{parentName:"p",href:"./search-and-query-advanced-expressions"},"\u4f7f\u7528\u9ad8\u7ea7\u8868\u8fbe\u5f0f\u641c\u7d22\u548c\u67e5\u8be2")))))}g.isMDXComponent=!0}}]);