"use strict";(self.webpackChunksite=self.webpackChunksite||[]).push([[1822],{7064:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>p,contentTitle:()=>c,default:()=>g,frontMatter:()=>s,metadata:()=>d,toc:()=>u});var a=t(7462),i=(t(7294),t(3905)),r=t(3612),l=t(4866),o=t(5162);const s={slug:"/docs/search-and-query-advanced-expressions",beta:!0,notebook:"10_search_query_advanced_ops.ipynb",sidebar_position:4},c="\u4f7f\u7528\u9ad8\u7ea7\u8868\u8fbe\u5f0f\u641c\u7d22\u548c\u67e5\u8be2",d={unversionedId:"tutorials/collection/search-and-query/search-and-query-advanced-expressions",id:"tutorials/collection/search-and-query/search-and-query-advanced-expressions",title:"\u4f7f\u7528\u9ad8\u7ea7\u8868\u8fbe\u5f0f\u641c\u7d22\u548c\u67e5\u8be2",description:"\u672c\u6307\u5357\u5c06\u4ecb\u7ecd\u5982\u4f55\u5728 Zilliz Cloud \u4e2d\u4f7f\u7528\u9ad8\u7ea7\u8868\u8fbe\u5f0f count() \u548c json_contains() \u6765\u6267\u884c\u641c\u7d22\u6216\u67e5\u8be2\u64cd\u4f5c\u3002",source:"@site/docs/tutorials/collection/search-and-query/search-and-query-advanced-expressions.md",sourceDirName:"tutorials/collection/search-and-query",slug:"/docs/search-and-query-advanced-expressions",permalink:"/docs/search-and-query-advanced-expressions",draft:!1,tags:[],version:"current",sidebarPosition:4,frontMatter:{slug:"/docs/search-and-query-advanced-expressions",beta:!0,notebook:"10_search_query_advanced_ops.ipynb",sidebar_position:4},sidebar:"tutorialSidebar",previous:{title:"\u4f7f\u7528\u8fed\u4ee3\u5668\u641c\u7d22\u548c\u67e5\u8be2",permalink:"/docs/search-and-query-iterators"},next:{title:"\u9ad8\u7ea7\u529f\u80fd",permalink:"/advanced-features"}},p={},u=[{value:"\u6982\u8ff0",id:"overview",level:2},{value:"\u5f00\u59cb\u524d",id:"before-you-start",level:2},{value:"\u51c6\u5907\u6570\u636e",id:"prepare-your-dataset",level:2},{value:"\u5411 Collection \u63d2\u5165\u6570\u636e",id:"insert-data-into-the-collection",level:2},{value:"\u4f7f\u7528 <code>count()</code>",id:"use-count",level:2},{value:"\u67e5\u8be2\u6240\u6709 Entity \u7684\u6570\u91cf",id:"count-all-entities",level:3},{value:"\u67e5\u8be2\u6ee1\u8db3\u7279\u5b9a\u6761\u4ef6\u7684 Entity \u7684\u6570\u91cf",id:"count-entities-based-on-conditions",level:3},{value:"\u4f7f\u7528 <code>json_contains()</code> \u8fdb\u884c\u641c\u7d22\u548c\u67e5\u8be2",id:"search-and-query-with-jsoncontains",level:2},{value:"\u5728\u5411\u91cf\u641c\u7d22\u4e2d\u4f7f\u7528 <code>json_contains()</code>",id:"use-jsoncontains-in-a-vector-search",level:3},{value:"\u5728\u67e5\u8be2\u4e2d\u4f7f\u7528 <code>json_contains()</code>",id:"use-jsoncontains-in-a-query",level:3},{value:"\u8868\u8fbe\u5f0f\u53c2\u8003",id:"expression-reference",level:2},{value:"\u76f8\u5173\u6587\u6863",id:"related-topics",level:2}],m={toc:u},h="wrapper";function g(e){let{components:n,...t}=e;return(0,i.kt)(h,(0,a.Z)({},m,t,{components:n,mdxType:"MDXLayout"}),(0,i.kt)("h1",{id:"\u4f7f\u7528\u9ad8\u7ea7\u8868\u8fbe\u5f0f\u641c\u7d22\u548c\u67e5\u8be2"},"\u4f7f\u7528\u9ad8\u7ea7\u8868\u8fbe\u5f0f\u641c\u7d22\u548c\u67e5\u8be2"),(0,i.kt)("p",null,"\u672c\u6307\u5357\u5c06\u4ecb\u7ecd\u5982\u4f55\u5728 Zilliz Cloud \u4e2d\u4f7f\u7528\u9ad8\u7ea7\u8868\u8fbe\u5f0f ",(0,i.kt)("inlineCode",{parentName:"p"},"count()")," \u548c ",(0,i.kt)("inlineCode",{parentName:"p"},"json_contains()")," \u6765\u6267\u884c\u641c\u7d22\u6216\u67e5\u8be2\u64cd\u4f5c\u3002"),(0,i.kt)("h2",{id:"overview"},"\u6982\u8ff0"),(0,i.kt)("p",null,"Zilliz Cloud \u73b0\u5df2\u652f\u6301\u5728\u641c\u7d22\u6216\u67e5\u8be2\u65f6\u4f7f\u7528\u9ad8\u7ea7\u8868\u8fbe\u5f0f ",(0,i.kt)("inlineCode",{parentName:"p"},"count()")," \u548c ",(0,i.kt)("inlineCode",{parentName:"p"},"json_contains()"),"\u3002"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("inlineCode",{parentName:"p"},"count()"),"\uff1a\u7528\u4e8e\u68c0\u7d22 Collection \u4e2d\u7684 Entity \u6570\u91cf\u3002")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("inlineCode",{parentName:"p"},"json_contains()"),"\uff1a\u7528\u4e8e\u5224\u65ad JSON \u952e\u4e2d\u662f\u5426\u5305\u542b\u7279\u5b9a\u5143\u7d20\u3002"))),(0,i.kt)(r.Z,{type:"info",icon:"\ud83d\udcd8",title:"\u8bf4\u660e",mdxType:"Admonition"},(0,i.kt)("p",null,"\u76ee\u524d\uff0c",(0,i.kt)("inlineCode",{parentName:"p"},"count()")," \u548c ",(0,i.kt)("inlineCode",{parentName:"p"},"json_contains()")," \u5904\u4e8e Beta \u6d4b\u8bd5\u9636\u6bb5\u3002\u8bf7\u6ce8\u610f\uff0c\u8be5\u529f\u80fd\u53ca\u76f8\u5173\u6587\u6863\u5728 Beta \u6d4b\u8bd5\u671f\u95f4\u53ef\u80fd\u4f1a\u6709\u6240\u66f4\u6539\u3002")),(0,i.kt)("h2",{id:"before-you-start"},"\u5f00\u59cb\u524d"),(0,i.kt)("p",null,"\u5728\u4f7f\u7528\u8fd9\u4e9b\u9ad8\u7ea7\u8868\u8fbe\u5f0f\u4e4b\u524d\uff0c\u8bf7\u786e\u4fdd\u4ee5\u4e0b\u51e0\u70b9\uff1a"),(0,i.kt)("p",null,"[Unsupported block type]"),(0,i.kt)("h2",{id:"prepare-your-dataset"},"\u51c6\u5907\u6570\u636e"),(0,i.kt)("p",null,"\u4f7f\u7528 ",(0,i.kt)("inlineCode",{parentName:"p"},"json_contains()")," \u4e4b\u524d\uff0c\u9700\u8981\u5b9a\u4e49\u4e00\u4e2a\u540d\u4e3a ",(0,i.kt)("inlineCode",{parentName:"p"},"article_meta")," \u7684 JSON \u5b57\u6bb5\uff0c\u5e76\u521b\u5efa\u4e0e\u6570\u636e\u96c6 Schema \u76f8\u5339\u914d\u7684 Collection\u3002"),(0,i.kt)(l.Z,{groupId:"code",defaultValue:"python",values:[{label:"Python",value:"python"},{label:"NodeJS",value:"javascript"},{label:"Java",value:"java"}],mdxType:"Tabs"},(0,i.kt)(o.Z,{value:"python",mdxType:"TabItem"},(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-python"},'# 0. Connect to cluster\nconnections.connect(\n    uri=CLUSTER_ENDPOINT, # Public endpoint obtained from Zilliz Cloud\n    token=TOKEN, # API key or a colon-separated cluster username and password\n)\n\n# 1. Define fields\nfields = [\n    FieldSchema(name="id", dtype=DataType.INT64, is_primary=True, auto_id=True, max_length=100),\n    FieldSchema(name="title", dtype=DataType.VARCHAR, max_length=512),\n    FieldSchema(name="title_vector", dtype=DataType.FLOAT_VECTOR, dim=768),\n    # The following field is a JSON field\n    FieldSchema(name="article_meta", dtype=DataType.JSON)\n]\n\n# 2. Build the schema\nschema = CollectionSchema(\n    fields,\n    description="Schema of Medium articles",\n    enable_dynamic_field=False\n)\n\n# 3. Create collection\ncollection = Collection(\n    name="medium_articles_with_json", \n    description="Medium articles published between Jan and August in 2020 in prominent publications",\n    schema=schema\n)\n\n# 4. index the vector field\nindex_params = {\n    "index_type": "AUTOINDEX",\n    "metric_type": "L2",\n    "params": {}\n}\n\ncollection.create_index(\n  field_name="title_vector", \n  index_params=index_params\n)\n\n# 5. load the collection\ncollection.load()\n\n# Get loading progress\nprogress = utility.loading_progress(COLLECTION_NAME)\n\nprint(progress)\n\n# Output\n#\n# {\n#     "loading_progress": "100%"\n# }\n'))),(0,i.kt)(o.Z,{value:"javascript",mdxType:"TabItem"},(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-javascript"},'async function main() {\n    // 1. Connect to the cluster\n    const client = new MilvusClient({address, token})\n    \n    // 2. Define fields\n    fields = [\n        {\n            name: "id",\n            data_type: DataType.Int64,\n            is_primary_key: true,\n            auto_id: true\n        },\n        {\n            name: "title",\n            data_type: DataType.VarChar,\n            max_length: 512\n        },\n        {\n            name: "title_vector",\n            data_type: DataType.FloatVector,\n            dim: 768\n        },\n        {\n            name: "article_meta",\n            // This field is a JSON field.\n            data_type: DataType.JSON\n        }\n    ]\n    \n    // 3. Create collection\n    res = await client.createCollection({\n        collection_name: collectionName,\n        fields: fields\n    })\n\n    console.log(res)\n\n    // Output\n    // \n    // { error_code: \'Success\', reason: \'\', code: 0 }\n    // \n\n    // 4. Create index\n    res = await client.createIndex({\n        collection_name: collectionName,\n        field_name: "title_vector",\n        index_type: "IVF_FLAT",\n        metric_type: "L2",\n        params: {\n            nlist: 16384\n        }\n    })\n\n    console.log(res)\n\n    // Output\n    // \n    // { error_code: \'Success\', reason: \'\', code: 0 }\n    // \n\n    res = await client.loadCollection({\n        collection_name: collectionName\n    })\n\n    console.log(res)\n\n    // Output\n    // \n    // { error_code: \'Success\', reason: \'\', code: 0 }\n    // \n'))),(0,i.kt)(o.Z,{value:"java",mdxType:"TabItem"},(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},'// 1. Connect to cluster\nConnectParam connectParam = ConnectParam.newBuilder()\n    .withUri(clusterEndpoint)\n    .withToken(token)\n    .build();\n\nMilvusServiceClient client = new MilvusServiceClient(connectParam);\n\nSystem.out.println("Connected to Zilliz Cloud!");\n// Output:\n// Connected to Zilliz Cloud!\n\n// 2. Create cluster\nFieldType id = FieldType.newBuilder()\n    .withName("id")\n    .withDataType(DataType.Int64)\n    .withPrimaryKey(true)\n    .withAutoID(true)\n    .build();\n\nFieldType title = FieldType.newBuilder()\n    .withName("title")\n    .withDataType(DataType.VarChar)\n    .withMaxLength(512)\n    .build();\n\nFieldType title_vector = FieldType.newBuilder()\n    .withName("title_vector")\n    .withDataType(DataType.FloatVector)\n    .withDimension(768)\n    .build(); \n\n// The following field is a JSON field.\nFieldType article_meta = FieldType.newBuilder()\n    .withName("article_meta")\n    .withDataType(DataType.JSON)\n    .build();\n\nCreateCollectionParam createCollectionParam = CreateCollectionParam.newBuilder()\n    .withCollectionName(collectionName)\n    .withDescription("Schema of Medium articles")\n    .addFieldType(id)\n    .addFieldType(title)\n    .addFieldType(title_vector)\n    .addFieldType(article_meta)\n    .build();\n\nR<RpcStatus> collection = client.createCollection(createCollectionParam);\n\nif (collection.getException() != null) {\n    System.err.println("Failed to create collection: " + collection.getException().getMessage());\n    return;\n}\n\nSystem.out.println("Successfully created a collection with name: " + collectionName);\n// Output:\n// Successfully created a collection with name: medium_articles\n\n// 3. Index and load the collection\n\n// Create index\nCreateIndexParam createIndexParam = CreateIndexParam.newBuilder()\n    .withCollectionName(collectionName)\n    .withFieldName("title_vector")\n    .withIndexName("title_vector_index")\n    .withIndexType(IndexType.AUTOINDEX)\n    .withMetricType(MetricType.L2)\n    .build();\n\nR<RpcStatus> res = client.createIndex(createIndexParam);\n\nif (res.getException() != null) {\n    System.err.println("Failed to create index: " + res.getException().getMessage());\n    return;\n}\n\nSystem.out.println("Successfully created index");\n// Output:\n// Successfully created index\n\n// Load collection\nLoadCollectionParam loadCollectionParam = LoadCollectionParam.newBuilder()\n    .withCollectionName(collectionName)\n    .build();\n\nR<RpcStatus> loadCollectionRes = client.loadCollection(loadCollectionParam);\n\nif (loadCollectionRes.getException() != null) {\n    System.err.println("Failed to load collection: " + loadCollectionRes.getException().getMessage());\n    return;\n}\n\nGetLoadingProgressParam getLoadingProgressParam = GetLoadingProgressParam.newBuilder()\n    .withCollectionName(collectionName)\n    .build();\n\nR<GetLoadingProgressResponse> getLoadingProgressRes = client.getLoadingProgress(getLoadingProgressParam);\n\nif (getLoadingProgressRes.getException() != null) {\n    System.err.println("Failed to get loading progress: " + getLoadingProgressRes.getException().getMessage());\n    return;\n}\n\nSystem.out.println("Successfully loaded collection");\n// Output:\n// Successfully loaded collection\n')))),(0,i.kt)("p",null,"\u521b\u5efa\u5e76\u7d22\u5f15\u5b8c Collection \u540e\uff0c\u5c06\u793a\u4f8b\u6570\u636e\u96c6\u683c\u5f0f\u5316\u4ee5\u9002\u5e94 Collection \u7684 Schema\u3002\u4ee5\u4e0b\u793a\u4f8b\u5c55\u793a\u4e86\u5982\u4f55\u5728 ",(0,i.kt)("inlineCode",{parentName:"p"},"article_meta")," JSON \u5b57\u6bb5\u4e2d\u589e\u52a0 ",(0,i.kt)("inlineCode",{parentName:"p"},"tags_1")," \u548c ",(0,i.kt)("inlineCode",{parentName:"p"},"tags_2")," \u4e24\u4e2a\u65b0\u884c\uff1a"),(0,i.kt)(l.Z,{groupId:"code",defaultValue:"python",values:[{label:"Python",value:"python"},{label:"NodeJS",value:"javascript"},{label:"Java",value:"java"}],mdxType:"Tabs"},(0,i.kt)(o.Z,{value:"python",mdxType:"TabItem"},(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-python"},"# 6. Prepare data\n\n# Prepare a list of rows\nwith open(\"path/to/medium_articles_2020_dpr.json\") as f:\n    data = json.load(f)\n    list_of_rows = data['rows']\n\n    rows = []\n    for row in list_of_rows:\n        # Remove the id field because auto-id is enabled for the primary key\n        del row['id']\n        # Create the article_meta field and \n        row['article_meta'] = {}\n        # Move the following keys into the article_meta field\n        row['article_meta']['link'] = row.pop('link')\n        row['article_meta']['reading_time'] = row.pop('reading_time')\n        row['article_meta']['publication'] = row.pop('publication')\n        row['article_meta']['claps'] = row.pop('claps')\n        row['article_meta']['responses'] = row.pop('responses')\n        row['article_meta']['tags_1'] = [ random.randint(0, 40) for x in range(40)]\n        row['article_meta']['tags_2'] = [ [ random.randint(0, 40) for y in range(4) ] for x in range(10) ]\n        # Append this row to the data_rows list\n        rows.append(row)\n\nprint(rows[:1])\n\n# Output\n#\n# [\n#     {\n#         \"title\": \"The Reported Mortality Rate of Coronavirus Is Not Important\",\n#         \"title_vector\": [\n#             0.041732933,\n#             0.013779674,\n#             -0.027564144,\n#             -0.013061441,\n#             0.009748648,\n#             0.00082446384,\n#             -0.00071647146,\n#             0.048612226,\n#             -0.04836573,\n#             -0.04567751,\n#             \"(758 more items hidden)\"\n#         ],\n#         \"article_meta\": {\n#             \"link\": \"https://medium.com/swlh/the-reported-mortality-rate-of-coronavirus-is-not-important-369989c8d912\",\n#             \"reading_time\": 13,\n#             \"publication\": \"The Startup\",\n#             \"claps\": 1100,\n#             \"responses\": 18,\n#             \"tags_1\": [\n#                 20,\n#                 39,\n#                 4,\n#                 4,\n#                 11,\n#                 30,\n#                 6,\n#                 23,\n#                 29,\n#                 1,\n#                 \"(30 more items hidden)\"\n#             ],\n#             \"tags_2\": [\n#                 [\n#                     37,\n#                     29,\n#                     23,\n#                     27\n#                 ],\n#                 [\n#                     6,\n#                     34,\n#                     17,\n#                     33\n#                 ],\n#                 [\n#                     39,\n#                     9,\n#                     15,\n#                     37\n#                 ],\n#                 [\n#                     3,\n#                     28,\n#                     21,\n#                     10\n#                 ],\n#                 [\n#                     40,\n#                     15,\n#                     36,\n#                     20\n#                 ],\n#                 [\n#                     15,\n#                     24,\n#                     40,\n#                     26\n#                 ],\n#                 [\n#                     8,\n#                     36,\n#                     18,\n#                     19\n#                 ],\n#                 [\n#                     36,\n#                     21,\n#                     16,\n#                     28\n#                 ],\n#                 [\n#                     14,\n#                     6,\n#                     32,\n#                     18\n#                 ],\n#                 [\n#                     23,\n#                     31,\n#                     36,\n#                     39\n#                 ]\n#             ]\n#         }\n#     }\n# ]\n"))),(0,i.kt)(o.Z,{value:"javascript",mdxType:"TabItem"},(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-javascript"},"// 5. Prepare dataset\n    \n    const data = JSON.parse(fs.readFileSync(data_file))\n\n    // read rows\n    const rows = data[\"rows\"]\n    rows.forEach(row => {\n        // add a new field in the row object\n        row.article_meta = {}\n        // move the following fields into the new field\n        row.article_meta.link = row.link\n        delete row.link\n        row.article_meta.reading_time = row.reading_time\n        delete row.reading_time\n        row.article_meta.publication = row.publication\n        delete row.publication\n        row.article_meta.claps = row.claps\n        delete row.claps\n        row.article_meta.responses = row.responses\n        delete row.responses\n        row.article_meta.tags_1 = Array.from({length: 40}, () => Math.floor(Math.random() * 40));   \n        row.article_meta.tags_2 = Array.from({length: 10}, () => Array.from({length: 4}, () => Math.floor(Math.random() * 40)))      \n    });\n\n    console.log(Object.keys(rows[0]))\n\n    // Output\n    // \n    // [ 'id', 'title', 'title_vector', 'article_meta' ]\n    // \n"))),(0,i.kt)(o.Z,{value:"java",mdxType:"TabItem"},(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},'// 4. Read a local file\nPath file = Path.of(data_file);\nString content;\n\ntry {\n    content = Files.readString(file);\n} catch (Exception e) {\n    System.err.println("Failed to read file: " + e.getMessage());\n    return;\n}\n\nSystem.out.println("Successfully read file");\n// Output:\n// Successfully read file\n\n// Load dataset\nJSONObject dataset = JSON.parseObject(content);\n\n// In addition to the original data, we also need to add some tags fields.\n// The tags fields are used to demonstrate the use of the advanced expression.\n// For details, examine the getRows function\nList<JSONObject> rows = getRows(dataset.getJSONArray("rows"), 5979);\n')))),(0,i.kt)("h2",{id:"insert-data-into-the-collection"},"\u5411 Collection \u63d2\u5165\u6570\u636e"),(0,i.kt)("p",null,"\u4f7f\u7528\u4ee5\u4e0b\u4ee3\u7801\u5c06\u51c6\u5907\u597d\u7684\u6570\u636e\u63d2\u5165\u5230 Collection \u4e2d\uff1a"),(0,i.kt)(l.Z,{groupId:"code",defaultValue:"python",values:[{label:"Python",value:"python"},{label:"NodeJS",value:"javascript"},{label:"Java",value:"java"}],mdxType:"Tabs"},(0,i.kt)(o.Z,{value:"python",mdxType:"TabItem"},(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-python"},'# 7. Insert data\nresults = collection.insert(rows)\n\nprint(f"Data inserted successfully! inserted rows: {results.insert_count}")\n\n# Output\n#\n# Data inserted successfully! inserted rows: 5979\n'))),(0,i.kt)(o.Z,{value:"javascript",mdxType:"TabItem"},(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-javascript"},"    //insert vectors\n    res = await client.insert({\n        collection_name: collectionName,\n        data: rows\n    })\n\n    console.log(res)\n\n    // Output\n    // \n    // {\n    //   succ_index: [\n    //      0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11,\n    //     12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23,\n    //     24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35,\n    //     36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47,\n    //     48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59,\n    //     60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71,\n    //     72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83,\n    //     84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95,\n    //     96, 97, 98, 99,\n    //     ... 5879 more items\n    //   ],\n    //   err_index: [],\n    //   status: { error_code: 'Success', reason: '', code: 0 },\n    //   IDs: { int_id: { data: [Array] }, id_field: 'int_id' },\n    //   acknowledged: false,\n    //   insert_cnt: '5979',\n    //   delete_cnt: '0',\n    //   upsert_cnt: '0',\n    //   timestamp: '445318026051190787'\n    // }\n    // \n\n    await sleep(5000)\n"))),(0,i.kt)(o.Z,{value:"java",mdxType:"TabItem"},(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},'InsertParam insertParam = InsertParam.newBuilder()\n    .withCollectionName(collectionName)\n    .withRows(rows)\n    .build();\n\nR<MutationResult> insertResponse = client.insert(insertParam);\n\nif (insertResponse.getStatus() != R.Status.Success.getCode()) {\n    System.err.println(insertResponse.getMessage());\n}\n\nMutationResultWrapper mutationResultWrapper = new MutationResultWrapper(insertResponse.getData());\n\nSystem.out.println("Successfully insert entities: " + mutationResultWrapper.getInsertCount());\n// Output:\n// Successfully insert entities: 5979\n\n// Wait for a while\ntry {\n    // pause execution for 5 seconds\n    Thread.sleep(5000);\n} catch (InterruptedException e) {\n    // handle the exception\n    Thread.currentThread().interrupt();\n}\n')))),(0,i.kt)("h2",{id:"use-count"},"\u4f7f\u7528 ",(0,i.kt)("inlineCode",{parentName:"h2"},"count()")),(0,i.kt)("p",null,"\u5728\u641c\u7d22\u6216\u67e5\u8be2\u65f6\uff0c\u5c06 ",(0,i.kt)("inlineCode",{parentName:"p"},"count()")," \u5305\u542b\u5728 ",(0,i.kt)("inlineCode",{parentName:"p"},"output_fields")," \u4e2d\u53ef\u4ee5\u68c0\u7d22 Collection \u5185\u7684 Entity \u6570\u91cf\u3002\u82e5\u9700\u67e5\u8be2\u6ee1\u8db3\u7279\u5b9a\u6761\u4ef6\u7684 Entity \u6570\u91cf\uff0c\u53ef\u4f7f\u7528 ",(0,i.kt)("inlineCode",{parentName:"p"},"expr")," \u53c2\u6570\u8fdb\u884c\u6570\u636e\u8fc7\u6ee4\u3002"),(0,i.kt)("h3",{id:"count-all-entities"},"\u67e5\u8be2\u6240\u6709 Entity \u7684\u6570\u91cf"),(0,i.kt)("p",null,"\u4f7f\u7528\u4ee5\u4e0b\u4ee3\u7801\u67e5\u8be2 Collection \u4e2d\u7684\u603b Entity \u6570\u91cf\uff1a"),(0,i.kt)(l.Z,{groupId:"code",defaultValue:"python",values:[{label:"Python",value:"python"},{label:"NodeJS",value:"javascript"},{label:"Java",value:"java"}],mdxType:"Tabs"},(0,i.kt)(o.Z,{value:"python",mdxType:"TabItem"},(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-python"},"num_of_entities = collection.query(expr=\"\",output_fields=[\"count(*)\"])\n\nprint(num_of_entities)\nprint(num_of_entities[0])\n\n# Output:\n# [{'count(*)': 5979}]\n# {'count(*)': 5979}\n"))),(0,i.kt)(o.Z,{value:"javascript",mdxType:"TabItem"},(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-javascript"},"    // 6. Count entities\n\n    counts = await client.query({\n        collection_name: collectionName,\n        filter: \"\",\n        output_fields: [\"count(*)\"]\n    })\n\n    console.log(counts)\n\n    // Output\n    // \n    // {\n    //   status: { error_code: 'Success', reason: '', code: 0 },\n    //   data: [ { 'count(*)': '5979' } ]\n    // }\n    // \n"))),(0,i.kt)(o.Z,{value:"java",mdxType:"TabItem"},(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},'// 5. Count the entities using the \'count(*)\' field\n\nList<String> outputFields1 = new ArrayList<>();\noutputFields1.add("count(*)");\n\nQueryParam queryParam1 = QueryParam.newBuilder()\n    .withCollectionName(collectionName)\n    .withExpr("")\n    .withOutFields(outputFields1)\n    .build();\n\nR<QueryResults> queryResponse1 = client.query(queryParam1);\n\nif (queryResponse1.getException() != null) {\n    System.err.println("Failed to query: " + queryResponse1.getException().getMessage());\n    return;\n}\n\nQueryResultsWrapper queryResultsWrapper1 = new QueryResultsWrapper(queryResponse1.getData());\n\nint count1 = ((Long) queryResultsWrapper1.getFieldWrapper("count(*)").getFieldData().get(0)).intValue();\n\nSystem.out.println("The collection contains exactly " + count1 + " entities!");\n// Output:\n// The collection contains exactly 5979 entities!\n')))),(0,i.kt)("p",null,"\u4ee5\u4e0a\u4ee3\u7801\u5c06\u8fd4\u56de Collection \u4e2d\u7684 Entity \u603b\u6570\uff0c\u56e0\u4e3a\u6ca1\u6709\u5728 ",(0,i.kt)("inlineCode",{parentName:"p"},"expr")," \u53c2\u6570\u4e2d\u8bbe\u7f6e\u4efb\u4f55\u8fc7\u6ee4\u6761\u4ef6\u3002"),(0,i.kt)("h3",{id:"count-entities-based-on-conditions"},"\u67e5\u8be2\u6ee1\u8db3\u7279\u5b9a\u6761\u4ef6\u7684 Entity \u7684\u6570\u91cf"),(0,i.kt)("p",null,"\u67e5\u8be2\u6ee1\u8db3\u7279\u5b9a\u6761\u4ef6\u7684 entities \u6570\u91cf\uff1a"),(0,i.kt)(l.Z,{groupId:"code",defaultValue:"python",values:[{label:"Python",value:"python"},{label:"NodeJS",value:"javascript"},{label:"Java",value:"java"}],mdxType:"Tabs"},(0,i.kt)(o.Z,{value:"python",mdxType:"TabItem"},(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-python"},"entities = collection.query(\n    expr='article_meta[\"claps\"] > 30 and article_meta[\"reading_time\"] < 10',\n    output_fields=[\"count(*)\"]\n)\n\nprint(entities)\nprint(entities[0])\n\n# Output:\n# [{'count(*)': 4304}]\n# {'count(*)': 4304}\n"))),(0,i.kt)(o.Z,{value:"javascript",mdxType:"TabItem"},(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-javascript"},"    // 7. Count entities with condition\n\n    // matches all articles with tags_1 having the member 16\n    const expr_1 = 'JSON_CONTAINS(article_meta[\"tags_1\"], 16)'\n\n    // matches all articles with tags_2 having the member [5, 3, 39, 8]\n    const expr_2 = 'JSON_CONTAINS(article_meta[\"tags_2\"], [5, 3, 39, 8])'\n\n    // matches all articles with tags_1 having a member from [5, 3, 39, 8]\n    const expr_3 = 'JSON_CONTAINS_ANY(article_meta[\"tags_1\"], [5, 3, 39, 8])'\n\n    // matches all articles with tags_1 having all members from [2, 4, 6]\n    const expr_4 = 'JSON_CONTAINS_ALL(article_meta[\"tags_1\"], [2, 4, 6])'\n\n    counts = await client.query({\n        collection_name: collectionName,\n        filter: expr_1,\n        output_fields: [\"count(*)\"]\n    })\n\n    console.log(counts)\n\n    // Output\n    // \n    // {\n    //   status: { error_code: 'Success', reason: '', code: 0 },\n    //   data: [ { 'count(*)': '3825' } ]\n    // }\n    // \n"))),(0,i.kt)(o.Z,{value:"java",mdxType:"TabItem"},(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},'// 6. Count the entities with filters\n\nList<String> outputFields2 = new ArrayList<>();\noutputFields2.add("count(*)");\n\nQueryParam queryParam2 = QueryParam.newBuilder()\n    .withCollectionName(collectionName)\n    .withExpr("article_meta[\\"claps\\"] > 30 and article_meta[\\"reading_time\\"] < 10")\n    .withOutFields(outputFields2)\n    .build();\n\nR<QueryResults> queryResponse2 = client.query(queryParam2);\n\nif (queryResponse2.getException() != null) {\n    System.err.println("Failed to query: " + queryResponse2.getException().getMessage());\n    return;\n}\n\nQueryResultsWrapper queryResultsWrapper2 = new QueryResultsWrapper(queryResponse2.getData());\n\nint count2 = ((Long) queryResultsWrapper2.getFieldWrapper("count(*)").getFieldData().get(0)).intValue();\n\nSystem.out.println("The collection contains exactly " + count2 + " entities!");\n// Output:\n// The collection contains exactly 4304 entities!\n')))),(0,i.kt)("p",null,"\u4ee5\u4e0a\u4ee3\u7801\u5c06\u67e5\u8be2\u540c\u65f6\u6ee1\u8db3\u4ee5\u4e0b\u4e24\u4e2a\u6761\u4ef6\u7684 Entity \u6570\u91cf\uff1a"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("inlineCode",{parentName:"p"},"article_meta")," \u4e2d ",(0,i.kt)("inlineCode",{parentName:"p"},"claps")," \u8d85\u8fc7 30\u3002")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("inlineCode",{parentName:"p"},"article_meta")," \u4e2d ",(0,i.kt)("inlineCode",{parentName:"p"},"reading_time")," \u5c11\u4e8e 10\u3002"))),(0,i.kt)("h2",{id:"search-and-query-with-jsoncontains"},"\u4f7f\u7528 ",(0,i.kt)("inlineCode",{parentName:"h2"},"json_contains()")," \u8fdb\u884c\u641c\u7d22\u548c\u67e5\u8be2"),(0,i.kt)("p",null,"\u5728\u641c\u7d22\u6216\u67e5\u8be2\u64cd\u4f5c\u4e2d\uff0c\u4f7f\u7528 ",(0,i.kt)("inlineCode",{parentName:"p"},"json_contains()")," \u6765\u68c0\u67e5 JSON \u952e\u5185\u662f\u5426\u5b58\u5728\u7279\u5b9a\u503c\u3002"),(0,i.kt)("h3",{id:"use-jsoncontains-in-a-vector-search"},"\u5728\u5411\u91cf\u641c\u7d22\u4e2d\u4f7f\u7528 ",(0,i.kt)("inlineCode",{parentName:"h3"},"json_contains()")),(0,i.kt)("p",null,"\u4f7f\u7528 ",(0,i.kt)("inlineCode",{parentName:"p"},"JSON_CONTAINS()")," \u8fc7\u6ee4\u7ed3\u679c\uff0c\u4ee5\u67e5\u627e ",(0,i.kt)("inlineCode",{parentName:"p"},'article_meta["tags_1"]')," \u4e2d\u5305\u542b\u5143\u7d20 ",(0,i.kt)("inlineCode",{parentName:"p"},"16")," \u7684\u6570\u636e\uff1a"),(0,i.kt)(l.Z,{groupId:"code",defaultValue:"python",values:[{label:"Python",value:"python"},{label:"NodeJS",value:"javascript"},{label:"Java",value:"java"}],mdxType:"Tabs"},(0,i.kt)(o.Z,{value:"python",mdxType:"TabItem"},(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-python"},'# Define search parameters\nsearch_params = {\n    "metric_type": "L2",\n    "params": {"nprobe": 10}\n}\n\nres = collection.search(\n    data=[query_vector],\n    anns_field="title_vector",\n    param={"metric_type": "L2", "params": {"nprobe": 10}},\n    limit=5,\n    expr=\'JSON_CONTAINS(article_meta["tags_1"], 16)\',\n    output_fields=["title", "article_meta"]\n)\n\nids = [ hits.ids for hits in res ]\n\nprint(ids)\n\n# Output\n#\n# [\n#     [\n#         445311585782930475,\n#         445311585782930509,\n#         445311585782928309,\n#         445311585782929013,\n#         445311585782925710\n#     ]\n# ]\n\ndistances = [ hits.distances for hits in res ]\n\nprint(distances)\n\n# Output\n#\n# [\n#     [\n#         0.36103832721710205,\n#         0.37674015760421753,\n#         0.416297972202301,\n#         0.4928317368030548,\n#         0.49443864822387695\n#     ]\n# ]\n\ndef get_tags_1(value, target):\n    try:\n        return value.index(target) >= 0\n    except (ValueError):\n        return False\n\nresults = [ {\n    "id": hit.id,\n    "distance": hit.distance,\n    "entity": {\n        "title": hit.entity.get("title"),\n        "link": hit.entity.get("article_meta")[\'link\'],\n        "tags_1": get_tags_1(hit.entity.get("article_meta")["tags_1"], 16),\n    }\n} for hits in res for hit in hits ]\n\nprint(results)\n\n# Output\n#\n# [\n#     {\n#         "id": 445311585782930475,\n#         "distance": 0.36103832721710205,\n#         "entity": {\n#             "title": "The Hidden Side Effect of the Coronavirus",\n#             "link": "https://medium.com/swlh/the-hidden-side-effect-of-the-coronavirus-b6a7a5ee9586",\n#             "tags_1": true\n#         }\n#     },\n#     {\n#         "id": 445311585782930509,\n#         "distance": 0.37674015760421753,\n#         "entity": {\n#             "title": "Why The Coronavirus Mortality Rate is Misleading",\n#             "link": "https://towardsdatascience.com/why-the-coronavirus-mortality-rate-is-misleading-cc63f571b6a6",\n#             "tags_1": true\n#         }\n#     },\n#     {\n#         "id": 445311585782928309,\n#         "distance": 0.416297972202301,\n#         "entity": {\n#             "title": "Coronavirus shows what ethical Amazon could look like",\n#             "link": "https://medium.com/swlh/coronavirus-shows-what-ethical-amazon-could-look-like-7c80baf2c663",\n#             "tags_1": true\n#         }\n#     },\n#     {\n#         "id": 445311585782929013,\n#         "distance": 0.4928317368030548,\n#         "entity": {\n#             "title": "Will Coronavirus Impact Freelancers\\u2019 Ability to Rent?",\n#             "link": "https://medium.com/swlh/will-coronavirus-impact-freelancers-ability-to-rent-ae11f2847bab",\n#             "tags_1": true\n#         }\n#     },\n#     {\n#         "id": 445311585782925710,\n#         "distance": 0.49443864822387695,\n#         "entity": {\n#             "title": "Choosing the right performance metrics can save lives against Coronavirus",\n#             "link": "https://towardsdatascience.com/choosing-the-right-performance-metrics-can-save-lives-against-coronavirus-2f27492f6638",\n#             "tags_1": true\n#         }\n#     }\n# ]\n'))),(0,i.kt)(o.Z,{value:"javascript",mdxType:"TabItem"},(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-javascript"},"    // 8. Check if a specific element exists in JSON field\n\n    // Search\n\n    res = await client.search({\n        collection_name: collectionName,\n        vector: rows[0].title_vector,\n        limit: 5,\n        filter: expr_3,\n        output_fields: [\"title\", \"article_meta\"]\n    })\n\n    console.log(res)\n\n    // Output\n    // \n    // {\n    //   status: { error_code: 'Success', reason: '', code: 0 },\n    //   results: [\n    //     {\n    //       score: 0,\n    //       id: '0',\n    //       title: 'The Reported Mortality Rate of Coronavirus Is Not Important',\n    //       article_meta: [Object]\n    //     },\n    //     {\n    //       score: 0.29999834299087524,\n    //       id: '3177',\n    //       title: 'Following the Spread of Coronavirus',\n    //       article_meta: [Object]\n    //     },\n    //     {\n    //       score: 0.36103832721710205,\n    //       id: '5607',\n    //       title: 'The Hidden Side Effect of the Coronavirus',\n    //       article_meta: [Object]\n    //     },\n    //     {\n    //       score: 0.37674015760421753,\n    //       id: '5641',\n    //       title: 'Why The Coronavirus Mortality Rate is Misleading',\n    //       article_meta: [Object]\n    //     },\n    //     {\n    //       score: 0.416297972202301,\n    //       id: '3441',\n    //       title: 'Coronavirus shows what ethical Amazon could look like',\n    //       article_meta: [Object]\n    //     }\n    //   ]\n    // }\n    // \n\n    tags_1 = res.results.map((item) => item.article_meta[\"tags_1\"])\n\n    console.log(tags_1)\n\n    // Output\n    // \n    // [\n    //   [\n    //     24, 20, 37, 11,  3, 16, 26, 39, 18, 34,\n    //     13, 25,  9, 37, 29, 30, 18, 34, 27, 22,\n    //      6, 23,  3,  5, 14,  0, 23,  2, 36, 37,\n    //     31, 28,  7, 18, 16,  1,  9, 12, 17,  3\n    //   ],\n    //   [\n    //      9,  6, 34, 16,  2,  5, 15, 36,  6, 37,\n    //     17,  7,  7, 13, 21,  6, 33, 37, 16, 24,\n    //     35, 32, 17, 11, 33, 16, 22, 22, 39, 36,\n    //      7, 37, 15, 21, 31, 16,  8, 37, 18, 17\n    //   ],\n    //   [\n    //     23, 10, 35, 32, 23,  1,  1, 31, 10, 20,\n    //     20,  2, 15,  3,  3, 22,  8, 27, 24, 18,\n    //     36, 24, 22,  1, 24, 31,  9, 20, 25, 22,\n    //     10, 36, 29, 25,  3, 17, 37,  2,  6,  0\n    //   ],\n    //   [\n    //     37, 22, 38, 32, 20, 27,  3, 28, 23, 26,\n    //     23, 22, 24,  7, 38, 23,  2,  5, 19,  6,\n    //     14, 38, 24, 27, 11,  9, 30, 18, 38,  2,\n    //     19, 16,  9,  1, 12, 16,  4,  0,  5,  2\n    //   ],\n    //   [\n    //     18, 38, 28, 36,  0, 31, 31, 39,  1, 21,\n    //     18,  0, 18, 38, 20, 31, 17,  1, 37,  7,\n    //     29, 33, 13, 32, 29, 27, 27, 39, 19, 36,\n    //     30,  4, 21,  6, 31, 26, 35,  7, 11, 24\n    //   ]\n    // ]\n    // \n"))),(0,i.kt)(o.Z,{value:"java",mdxType:"TabItem"},(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},'// 7. Search with advanced filters\n\n// matches all articles with tags_1 having the member 16\nString expr_1 = "JSON_CONTAINS(article_meta[\\"tags_1\\"], 16)";\n\n// matches all articles with tags_2 having the member [5, 3, 39, 8]\nString expr_2 = "JSON_CONTAINS(article_meta[\\"tags_2\\"], [5, 3, 39, 8])";\n\n// matches all articles with tags_1 having a member from [5, 3, 39, 8]\nString expr_3 = "JSON_CONTAINS_ANY(article_meta[\\"tags_1\\"], [5, 3, 39, 8])";\n\n// matches all articles with tags_1 having all members from [2, 4, 6]\nString expr_4 = "JSON_CONTAINS_ALL(article_meta[\\"tags_1\\"], [2, 4, 6])";\n\n// prepare query vector\nList<List<Float>> queryVectors = new ArrayList<>();\nList<Float> queryVector1 = rows.get(0).getJSONArray("title_vector").toJavaList(Float.class);\nqueryVectors.add(queryVector1);\n\n// prepare output field\nList<String> outputFields = new ArrayList<>();\noutputFields.add("title");\noutputFields.add("article_meta");\n\n// Search vectors in a collection\nSearchParam searchParam = SearchParam.newBuilder()\n    .withCollectionName(collectionName)\n    .withVectorFieldName("title_vector")\n    .withVectors(queryVectors)\n    .withTopK(5)   \n    .withMetricType(MetricType.L2)  \n    .withParams("{\\"nprobe\\":10}")\n    .withConsistencyLevel(ConsistencyLevelEnum.BOUNDED)\n    .withOutFields(outputFields)\n    .withExpr(expr_1)\n    .build();\n\nR<SearchResults> response = client.search(searchParam);\n\nSearchResultsWrapper wrapper = new SearchResultsWrapper(response.getData().getResults());\n\nList<List<JSONObject>> results = new ArrayList<>();\n\nfor (int i = 0; i < queryVectors.size(); ++i) {\n    List<SearchResultsWrapper.IDScore> scores = wrapper.getIDScore(i);\n    List<JSONObject> entities = new ArrayList<>();\n    for (int j = 0; j < scores.size(); ++j) {\n        SearchResultsWrapper.IDScore score = scores.get(j);\n        JSONObject entity = new JSONObject(1, true);\n        entity.put("id", score.getLongID());\n        entity.put("distance", score.getScore());\n        entity.put("title", scores.get(j).get("title"));\n        entity.put("reading_time", ((JSONObject) scores.get(j).get("article_meta")).getLong("reading_time"));\n        entity.put("claps", ((JSONObject) scores.get(j).get("article_meta")).getLong("claps"));\n        entity.put("tags_1", ((JSONObject) scores.get(j).get("article_meta")).getJSONArray("tags_1").indexOf(16) >= 0);\n        entities.add(entity);\n    }\n    \n    results.add(entities);\n}\n\nSystem.out.println(results);\n\n// Output:\n// [[{"id":445337000188379768,"distance":0.29999834,"title":"Following the Spread of Coronavirus","reading_time":10,"claps":215,"tags_1":true}, {"id":445337000188382232,"distance":0.37674016,"title":"Why The Coronavirus Mortality Rate is Misleading","reading_time":9,"claps":2900,"tags_1":true}, {"id":445337000188377529,"distance":0.4360938,"title":"Mortality Rate As an Indicator of an Epidemic Outbreak","reading_time":6,"claps":65,"tags_1":true}, {"id":445337000188379663,"distance":0.4627558,"title":"Can we learn anything from the progression of influenza to analyze the COVID-19 pandemic better?","reading_time":5,"claps":2,"tags_1":true}, {"id":445337000188380919,"distance":0.48078254,"title":"Ever Wondered How Epidemiologists Simulate COVID-19 Deaths?","reading_time":4,"claps":20,"tags_1":true}]]\n')))),(0,i.kt)("h3",{id:"use-jsoncontains-in-a-query"},"\u5728\u67e5\u8be2\u4e2d\u4f7f\u7528 ",(0,i.kt)("inlineCode",{parentName:"h3"},"json_contains()")),(0,i.kt)("p",null,"\u4f7f\u7528 ",(0,i.kt)("inlineCode",{parentName:"p"},"JSON_CONTAINS_ALL()")," \u8fc7\u6ee4\u7ed3\u679c\uff0c\u4ee5\u67e5\u627e ",(0,i.kt)("inlineCode",{parentName:"p"},'article_meta["tags_1"]')," \u4e2d\u5305\u542b ",(0,i.kt)("inlineCode",{parentName:"p"},"[2, 4, 6]")," \u6240\u6709\u5143\u7d20\u7684\u6570\u636e\uff1a"),(0,i.kt)(l.Z,{groupId:"code",defaultValue:"python",values:[{label:"Python",value:"python"},{label:"NodeJS",value:"javascript"},{label:"Java",value:"java"}],mdxType:"Tabs"},(0,i.kt)(o.Z,{value:"python",mdxType:"TabItem"},(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-python"},'res = collection.query(\n    limit=5,\n    expr=\'JSON_CONTAINS_ALL(article_meta["tags_1"], [2, 4, 6])\',\n    output_fields=["title", "article_meta"]\n)\n\nres = [ {\n    "title": x.get("title"),\n    "article_meta": {\n        "link": x.get("article_meta")[\'link\'],\n        "reading_time": x.get("article_meta")[\'reading_time\'],\n        "publication": x.get("article_meta")[\'publication\'],\n        "claps": x.get("article_meta")[\'claps\'],\n        "responses": x.get("article_meta")[\'responses\'],\n        "tags_1": get_tags_1(x.get("article_meta")[\'tags_1\'], 2),\n    },\n} for x in res ]\n\nprint(res)\n\n# Output\n#\n# [\n#     {\n#         "title": "The Reported Mortality Rate of Coronavirus Is Not Important",\n#         "article_meta": {\n#             "link": "https://medium.com/swlh/the-reported-mortality-rate-of-coronavirus-is-not-important-369989c8d912",\n#             "reading_time": 13,\n#             "publication": "The Startup",\n#             "claps": 1100,\n#             "responses": 18,\n#             "tags_1": true\n#         }\n#     },\n#     {\n#         "title": "Dashboards in Python: 3 Advanced Examples for Dash Beginners and Everyone Else",\n#         "article_meta": {\n#             "link": "https://medium.com/swlh/dashboards-in-python-3-advanced-examples-for-dash-beginners-and-everyone-else-b1daf4e2ec0a",\n#             "reading_time": 14,\n#             "publication": "The Startup",\n#             "claps": 726,\n#             "responses": 3,\n#             "tags_1": true\n#         }\n#     },\n#     {\n#         "title": "Would you rather have 8% of $25 or 25% of $8?",\n#         "article_meta": {\n#             "link": "https://medium.com/swlh/would-you-rather-have-8-of-25-or-25-of-8-486b3bc48f28",\n#             "reading_time": 3,\n#             "publication": "The Startup",\n#             "claps": 208,\n#             "responses": 5,\n#             "tags_1": true\n#         }\n#     },\n#     {\n#         "title": "Big Reasons for Expanding Your Vocabulary, and How to Do It.",\n#         "article_meta": {\n#             "link": "https://medium.com/swlh/big-reasons-for-expanding-your-vocabulary-and-how-to-do-it-c78766e4df2",\n#             "reading_time": 8,\n#             "publication": "The Startup",\n#             "claps": 417,\n#             "responses": 3,\n#             "tags_1": true\n#         }\n#     },\n#     {\n#         "title": "How to Find Things and Do Research in a Discovery Phase",\n#         "article_meta": {\n#             "link": "https://medium.com/swlh/how-to-find-things-and-do-research-in-a-discovery-phase-6c3e4f50b208",\n#             "reading_time": 5,\n#             "publication": "The Startup",\n#             "claps": 330,\n#             "responses": 0,\n#             "tags_1": true\n#         }\n#     }\n# ]\n'))),(0,i.kt)(o.Z,{value:"javascript",mdxType:"TabItem"},(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-javascript"},"    // Query\n\n    res = await client.query({\n        collection_name: collectionName,\n        filter: expr_4,\n        limit: 5,\n        output_fields: [\"title\", \"article_meta\"]\n    })\n\n    console.log(res)\n\n    // Output\n    // \n    // {\n    //   status: { error_code: 'Success', reason: '', code: 0 },\n    //   data: [\n    //     {\n    //       title: 'Maternity leave shouldn\u2019t set women back',\n    //       article_meta: [Object],\n    //       id: '3'\n    //     },\n    //     {\n    //       title: 'Python NLP Tutorial: Information Extraction and Knowledge Graphs',\n    //       article_meta: [Object],\n    //       id: '4'\n    //     },\n    //     {\n    //       title: 'Building Comprehensible Customer Churn Prediction Models',\n    //       article_meta: [Object],\n    //       id: '7'\n    //     },\n    //     {\n    //       title: '5 Underrated Traits That Separate Exceptional Teams From the Rest',\n    //       article_meta: [Object],\n    //       id: '8'\n    //     },\n    //     {\n    //       title: 'Building high performance startup teams',\n    //       article_meta: [Object],\n    //       id: '10'\n    //     }\n    //   ]\n    // }\n    // \n\n    tags_1 = res.data.map((item) => item.article_meta[\"tags_1\"])\n\n    console.log(tags_1)\n\n    // Output\n    // \n    // [\n    //   [\n    //      2, 34, 25, 19, 19,  6,  3, 37, 16,  1,\n    //     27,  9,  9, 26, 27, 34, 30, 12, 11, 36,\n    //     30,  3,  1,  2, 24,  4, 14, 33, 32, 14,\n    //     26, 12, 22, 28, 10,  6,  2, 39, 10, 34\n    //   ],\n    //   [\n    //     37,  3, 11, 27, 20,  6,  4, 33,  7,  4,\n    //     37, 39, 29, 19, 35, 24, 29, 25, 38, 25,\n    //      7, 27,  8, 19, 27,  7, 15, 36,  8, 28,\n    //     29, 13, 13, 30, 29, 30, 22,  2, 35, 30\n    //   ],\n    //   [\n    //      4, 26,  1, 31, 10,  5, 33, 8,  0,  2,\n    //     39, 37, 38, 25, 12, 28, 19, 9, 13, 29,\n    //     22, 19, 24, 25,  3, 34, 22, 3,  9,  3,\n    //      8, 27, 36, 26,  5, 20, 18, 6, 26, 30\n    //   ],\n    //   [\n    //     27,  1,  5, 27, 14,  4,  2, 35,  6, 35,\n    //     34,  0, 22, 37, 33,  4,  0, 26,  7,  1,\n    //     22, 21,  8, 28, 31, 24, 33, 22, 27, 22,\n    //     19, 20,  3, 34,  8, 13, 24, 28, 25, 34\n    //   ],\n    //   [\n    //     38, 12,  4, 18, 17,  2, 25, 31,  7, 23,\n    //      0, 10, 23, 35, 37, 32, 26,  9, 32, 27,\n    //      8, 38,  5, 30, 10, 10,  7, 25, 29, 10,\n    //     27, 23, 34, 27, 38,  0,  6, 38, 34, 23\n    //   ]\n    // ]\n    // \n\n"))),(0,i.kt)(o.Z,{value:"java",mdxType:"TabItem"},(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},'// Query\n\nQueryParam queryParam = QueryParam.newBuilder()\n    .withCollectionName(collectionName)\n    .withExpr(expr_1)\n    .withOutFields(outputFields)\n    .withLimit(5L)\n    .build();\n\nR<QueryResults> queryResponse = client.query(queryParam);\n\nif (queryResponse.getException() != null) {\n    System.err.println("Failed to query: " + queryResponse.getException().getMessage());\n    return;\n}\n\nQueryResultsWrapper queryResultsWrapper = new QueryResultsWrapper(queryResponse.getData());\n\nList<List<JSONObject>> queryResults = new ArrayList<>();\n\nList<Long> ids = (List<Long>) queryResultsWrapper.getFieldWrapper("id").getFieldData();\nList<String> titles = (List<String>) queryResultsWrapper.getFieldWrapper("title").getFieldData();\nList<?> articleMetas = queryResultsWrapper.getFieldWrapper("article_meta").getFieldData();\nList<JSONObject> entities = new ArrayList<>();\nfor (int j = 0; j < ids.size(); ++j) {\n    JSONObject entity = new JSONObject();\n    entity.put("id", ids.get(j));\n    entity.put("title", titles.get(j));\n\n    byte[] articleMetaBytes = (byte[]) articleMetas.get(j);\n    JSONObject articleMeta = JSON.parseObject(new String(articleMetaBytes));\n\n    articleMeta.put("tags_1", articleMeta.getJSONArray("tags_1").indexOf(16) >= 0);\n    articleMeta.remove("tags_2");\n\n    entity.put("article_meta", articleMeta);\n    entities.add(entity);\n}\n\nqueryResults.add(entities);\n\nSystem.out.println(queryResults);        \n\n// Output:\n// [[\n//     {\n//         "article_meta": {\n//             "reading_time": 13,\n//             "tags_1": true,\n//             "publication": "The Startup",\n//             "link": "https://medium.com/swlh/the-reported-mortality-rate-of-coronavirus-is-not-important-369989c8d912",\n//             "responses": 18,\n//             "claps": 1100\n//         },\n//         "id": 445535516305953765,\n//         "title": "The Reported Mortality Rate of Coronavirus Is Not Important"\n//     },\n//     {\n//         "article_meta": {\n//             "reading_time": 6,\n//             "tags_1": true,\n//             "publication": "The Startup",\n//             "link": "https://medium.com/swlh/how-can-we-best-switch-in-python-458fb33f7835",\n//             "responses": 7,\n//             "claps": 500\n//         },\n//         "id": 445535516305953767,\n//         "title": "How Can We Best Switch in Python?"\n//     },\n//     {\n//         "article_meta": {\n//             "reading_time": 6,\n//             "tags_1": true,\n//             "publication": "The Startup",\n//             "link": "https://medium.com/swlh/science-monday-can-you-drink-as-much-water-as-tom-brady-1a45cb802be8",\n//             "responses": 5,\n//             "claps": 142\n//         },\n//         "id": 445535516305953771,\n//         "title": "Science Monday: Can You Drink As Much Water As Tom Brady?"\n//     },\n//     {\n//         "article_meta": {\n//             "reading_time": 13,\n//             "tags_1": true,\n//             "publication": "The Startup",\n//             "link": "https://medium.com/swlh/building-comprehensible-customer-churn-prediction-models-ca61ecce529d",\n//             "responses": 4,\n//             "claps": 261\n//         },\n//         "id": 445535516305953772,\n//         "title": "Building Comprehensible Customer Churn Prediction Models"\n//     },\n//     {\n//         "article_meta": {\n//             "reading_time": 11,\n//             "tags_1": true,\n//             "publication": "The Startup",\n//             "link": "https://medium.com/swlh/building-high-performance-startup-teams-1a0611c0bdd4",\n//             "responses": 0,\n//             "claps": 188\n//         },\n//         "id": 445535516305953775,\n//         "title": "Building high performance startup teams"\n//     }\n// ]]\n')))),(0,i.kt)("h2",{id:"expression-reference"},"\u8868\u8fbe\u5f0f\u53c2\u8003"),(0,i.kt)("p",null,"\u4ee5\u4e0b\u8868\u683c\u8be6\u7ec6\u63cf\u8ff0\u4e86\u5229\u7528 ",(0,i.kt)("inlineCode",{parentName:"p"},"json_contains()")," \u8fdb\u884c\u641c\u7d22\u6216\u67e5\u8be2\u65f6\uff0c\u53ef\u4ee5\u5728 ",(0,i.kt)("inlineCode",{parentName:"p"},"expr")," \u4e2d\u4f7f\u7528\u7684\u5e03\u5c14\u8868\u8fbe\u5f0f\u3002"),(0,i.kt)("table",null,(0,i.kt)("thead",{parentName:"table"},(0,i.kt)("tr",{parentName:"thead"},(0,i.kt)("th",{parentName:"tr",align:null},"\u8868\u8fbe\u5f0f"),(0,i.kt)("th",{parentName:"tr",align:null},"\u793a\u4f8b"),(0,i.kt)("th",{parentName:"tr",align:null},"\u8bf4\u660e"))),(0,i.kt)("tbody",{parentName:"table"},(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"json_contains")," (",(0,i.kt)("inlineCode",{parentName:"td"},"JSON_CONTAINS"),")"),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"expr_1 = 'JSON_CONTAINS(article_meta[\"tags_1\"], 16)'"),(0,i.kt)("br",null)," ",(0,i.kt)("br",null),"  ",(0,i.kt)("inlineCode",{parentName:"td"},"expr_2 = 'JSON_CONTAINS(article_meta[\"tags_2\"], [5, 3, 39, 8])'")),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"expr_1")," \u5728 ",(0,i.kt)("inlineCode",{parentName:"td"},'article_meta["tags_1"]')," \u5305\u542b\u5143\u7d20 ",(0,i.kt)("inlineCode",{parentName:"td"},"16")," \u65f6\u8fd4\u56de True\u3002",(0,i.kt)("br",null)," ",(0,i.kt)("br",null),"  ",(0,i.kt)("inlineCode",{parentName:"td"},"expr_2"),"\u5728 ",(0,i.kt)("inlineCode",{parentName:"td"},'article_meta["tags_2"]')," \u5305\u542b\u5143\u7d20",(0,i.kt)("inlineCode",{parentName:"td"},"[5, 3, 39, 8]")," \u65f6\u8fd4\u56de True\u3002",(0,i.kt)("br",null)," ",(0,i.kt)("br",null))),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"json_contains_any")," (",(0,i.kt)("inlineCode",{parentName:"td"},"JSON_CONTAINS_ANY"),")"),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"expr_3 = 'JSON_CONTAINS_ANY(article_meta[\"tags_1\"], [5, 3, 39, 8])'")),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"expr_3")," \u5728 ",(0,i.kt)("inlineCode",{parentName:"td"},'article_meta["tags_1"]')," \u5305\u542b ",(0,i.kt)("inlineCode",{parentName:"td"},"[5, 3, 39, 8]")," \u4e2d\u4efb\u4e00\u5143\u7d20\u65f6\u8fd4\u56de True\u3002")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"json_contains_all")," (",(0,i.kt)("inlineCode",{parentName:"td"},"JSON_CONTAINS_ALL"),")"),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"expr_4 = 'JSON_CONTAINS_ALL(article_meta[\"tags_1\"], [2, 4, 6])'"),(0,i.kt)("br",null)," ",(0,i.kt)("br",null)),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"expr_4")," \u5728 ",(0,i.kt)("inlineCode",{parentName:"td"},'article_meta["tags_1"]')," \u5305\u542b ",(0,i.kt)("inlineCode",{parentName:"td"},"[2, 4, 6]")," \u7684\u6240\u6709\u5143\u7d20\u65f6\u8fd4\u56de True\u3002",(0,i.kt)("br",null)," ",(0,i.kt)("br",null))))),(0,i.kt)("h2",{id:"related-topics"},"\u76f8\u5173\u6587\u6863"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("a",{parentName:"p",href:"./create-collection"},"\u521b\u5efa Collection"))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("a",{parentName:"p",href:"./javascript-object-notation-json"},"\u4f7f\u7528 JSON \u7c7b\u578b\u5b57\u6bb5"))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("a",{parentName:"p",href:"./search-and-query-iterators"},"\u4f7f\u7528\u8fed\u4ee3\u5668\u641c\u7d22\u548c\u67e5\u8be2")))))}g.isMDXComponent=!0}}]);