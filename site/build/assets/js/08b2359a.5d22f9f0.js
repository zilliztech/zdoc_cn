"use strict";(self.webpackChunksite=self.webpackChunksite||[]).push([[6427],{3905:(e,t,n)=>{n.d(t,{Zo:()=>u,kt:()=>h});var a=n(7294);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function o(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var s=a.createContext({}),c=function(e){var t=a.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):l(l({},t),e)),n},u=function(e){var t=c(e.components);return a.createElement(s.Provider,{value:t},e.children)},p="mdxType",d={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},m=a.forwardRef((function(e,t){var n=e.components,i=e.mdxType,r=e.originalType,s=e.parentName,u=o(e,["components","mdxType","originalType","parentName"]),p=c(n),m=i,h=p["".concat(s,".").concat(m)]||p[m]||d[m]||r;return n?a.createElement(h,l(l({ref:t},u),{},{components:n})):a.createElement(h,l({ref:t},u))}));function h(e,t){var n=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var r=n.length,l=new Array(r);l[0]=m;var o={};for(var s in t)hasOwnProperty.call(t,s)&&(o[s]=t[s]);o.originalType=e,o[p]="string"==typeof e?e:i,l[1]=o;for(var c=2;c<r;c++)l[c]=n[c];return a.createElement.apply(null,l)}return a.createElement.apply(null,n)}m.displayName="MDXCreateElement"},5162:(e,t,n)=>{n.d(t,{Z:()=>l});var a=n(7294),i=n(6010);const r={tabItem:"tabItem_Ymn6"};function l(e){let{children:t,hidden:n,className:l}=e;return a.createElement("div",{role:"tabpanel",className:(0,i.Z)(r.tabItem,l),hidden:n},t)}},4866:(e,t,n)=>{n.d(t,{Z:()=>k});var a=n(7462),i=n(7294),r=n(6010),l=n(2466),o=n(6550),s=n(1980),c=n(7392),u=n(12);function p(e){return function(e){return i.Children.map(e,(e=>{if(!e||(0,i.isValidElement)(e)&&function(e){const{props:t}=e;return!!t&&"object"==typeof t&&"value"in t}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)}))?.filter(Boolean)??[]}(e).map((e=>{let{props:{value:t,label:n,attributes:a,default:i}}=e;return{value:t,label:n,attributes:a,default:i}}))}function d(e){const{values:t,children:n}=e;return(0,i.useMemo)((()=>{const e=t??p(n);return function(e){const t=(0,c.l)(e,((e,t)=>e.value===t.value));if(t.length>0)throw new Error(`Docusaurus error: Duplicate values "${t.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e}),[t,n])}function m(e){let{value:t,tabValues:n}=e;return n.some((e=>e.value===t))}function h(e){let{queryString:t=!1,groupId:n}=e;const a=(0,o.k6)(),r=function(e){let{queryString:t=!1,groupId:n}=e;if("string"==typeof t)return t;if(!1===t)return null;if(!0===t&&!n)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return n??null}({queryString:t,groupId:n});return[(0,s._X)(r),(0,i.useCallback)((e=>{if(!r)return;const t=new URLSearchParams(a.location.search);t.set(r,e),a.replace({...a.location,search:t.toString()})}),[r,a])]}function y(e){const{defaultValue:t,queryString:n=!1,groupId:a}=e,r=d(e),[l,o]=(0,i.useState)((()=>function(e){let{defaultValue:t,tabValues:n}=e;if(0===n.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(t){if(!m({value:t,tabValues:n}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${t}" but none of its children has the corresponding value. Available values are: ${n.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return t}const a=n.find((e=>e.default))??n[0];if(!a)throw new Error("Unexpected error: 0 tabValues");return a.value}({defaultValue:t,tabValues:r}))),[s,c]=h({queryString:n,groupId:a}),[p,y]=function(e){let{groupId:t}=e;const n=function(e){return e?`docusaurus.tab.${e}`:null}(t),[a,r]=(0,u.Nk)(n);return[a,(0,i.useCallback)((e=>{n&&r.set(e)}),[n,r])]}({groupId:a}),f=(()=>{const e=s??p;return m({value:e,tabValues:r})?e:null})();(0,i.useLayoutEffect)((()=>{f&&o(f)}),[f]);return{selectedValue:l,selectValue:(0,i.useCallback)((e=>{if(!m({value:e,tabValues:r}))throw new Error(`Can't select invalid tab value=${e}`);o(e),c(e),y(e)}),[c,y,r]),tabValues:r}}var f=n(2389);const v={tabList:"tabList__CuJ",tabItem:"tabItem_LNqP"};function b(e){let{className:t,block:n,selectedValue:o,selectValue:s,tabValues:c}=e;const u=[],{blockElementScrollPositionUntilNextRender:p}=(0,l.o5)(),d=e=>{const t=e.currentTarget,n=u.indexOf(t),a=c[n].value;a!==o&&(p(t),s(a))},m=e=>{let t=null;switch(e.key){case"Enter":d(e);break;case"ArrowRight":{const n=u.indexOf(e.currentTarget)+1;t=u[n]??u[0];break}case"ArrowLeft":{const n=u.indexOf(e.currentTarget)-1;t=u[n]??u[u.length-1];break}}t?.focus()};return i.createElement("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,r.Z)("tabs",{"tabs--block":n},t)},c.map((e=>{let{value:t,label:n,attributes:l}=e;return i.createElement("li",(0,a.Z)({role:"tab",tabIndex:o===t?0:-1,"aria-selected":o===t,key:t,ref:e=>u.push(e),onKeyDown:m,onClick:d},l,{className:(0,r.Z)("tabs__item",v.tabItem,l?.className,{"tabs__item--active":o===t})}),n??t)})))}function g(e){let{lazy:t,children:n,selectedValue:a}=e;const r=(Array.isArray(n)?n:[n]).filter(Boolean);if(t){const e=r.find((e=>e.props.value===a));return e?(0,i.cloneElement)(e,{className:"margin-top--md"}):null}return i.createElement("div",{className:"margin-top--md"},r.map(((e,t)=>(0,i.cloneElement)(e,{key:t,hidden:e.props.value!==a}))))}function T(e){const t=y(e);return i.createElement("div",{className:(0,r.Z)("tabs-container",v.tabList)},i.createElement(b,(0,a.Z)({},e,t)),i.createElement(g,(0,a.Z)({},e,t)))}function k(e){const t=(0,f.Z)();return i.createElement(T,(0,a.Z)({key:String(t)},e))}},5523:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>u,contentTitle:()=>s,default:()=>h,frontMatter:()=>o,metadata:()=>c,toc:()=>p});var a=n(7462),i=(n(7294),n(3905)),r=n(4866),l=n(5162);const o={slug:"/use-partition-key",sidebar_position:2},s="\u4f7f\u7528 Partition Key",c={unversionedId:"tutorials/advanced-user-guides/customize-collection-schema/use-partition-key",id:"tutorials/advanced-user-guides/customize-collection-schema/use-partition-key",title:"\u4f7f\u7528 Partition Key",description:"\u672c\u8282\u5c06\u5e2e\u52a9\u60a8\u4e86\u89e3\u5982\u4f55\u4f7f\u7528 Partition Key \u52a0\u901f\u5728 Collection \u4e2d\u7684\u6570\u636e\u68c0\u7d22\u3002",source:"@site/docs/tutorials/advanced-user-guides/customize-collection-schema/use-partition-key.md",sourceDirName:"tutorials/advanced-user-guides/customize-collection-schema",slug:"/use-partition-key",permalink:"/docs/use-partition-key",draft:!1,tags:[],version:"current",sidebarPosition:2,frontMatter:{slug:"/use-partition-key",sidebar_position:2},sidebar:"tutorialSidebar",previous:{title:"\u5f00\u542f\u52a8\u6001 Schema",permalink:"/docs/enable-dynamic-schema"},next:{title:"\u9ad8\u7ea7\u6570\u636e\u7c7b\u578b",permalink:"/docs/advanced-data-types"}},u={},p=[{value:"\u51c6\u5907\u5de5\u4f5c",id:"some-prep-work",level:2},{value:"\u521b\u5efa\u542f\u7528 Partition Key \u7684 Collection",id:"create-a-collection-with-partition-key-enabled",level:2},{value:"\u57fa\u4e8e Partition Key \u7684 ANN \u641c\u7d22",id:"ann-search-based-on-partition-key",level:2},{value:"\u5178\u578b\u4f7f\u7528\u573a\u666f",id:"typical-usage-scenarios",level:2}],d={toc:p},m="wrapper";function h(e){let{components:t,...n}=e;return(0,i.kt)(m,(0,a.Z)({},d,n,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("h1",{id:"\u4f7f\u7528-partition-key"},"\u4f7f\u7528 Partition Key"),(0,i.kt)("p",null,"\u672c\u8282\u5c06\u5e2e\u52a9\u60a8\u4e86\u89e3\u5982\u4f55\u4f7f\u7528 Partition Key \u52a0\u901f\u5728 Collection \u4e2d\u7684\u6570\u636e\u68c0\u7d22\u3002"),(0,i.kt)("p",null,"Partition Key \u5141\u8bb8 Zilliz Cloud \u6839\u636e\u6570\u636e\u7684\u6307\u5b9a\u952e\u503c\u5c06\u6570\u636e\u5b58\u5165\u4e0d\u540c\u7684 Partition \u4e2d\u3002\u8fd9\u6837\u60a8\u5c31\u53ef\u4ee5\u6839\u636e\u6307\u5b9a\u952e\u503c\u4e3a\u6570\u636e\u5206\u7ec4\uff0c\u4ece\u800c\u5728\u6839\u636e\u952e\u503c\u8fc7\u6ee4\u65f6\u907f\u514d\u626b\u63cf\u5b8c\u5168\u65e0\u5173\u7684 Partition\u3002\u76f8\u6bd4\u4f20\u7edf\u7684\u8fc7\u6ee4\u67e5\u8be2\u65b9\u5f0f\uff0c\u542f\u7528\u8be5\u7279\u6027\u540e\u53ef\u4ee5\u6781\u5927\u5730\u63d0\u5347\u67e5\u8be2\u6027\u80fd\u3002"),(0,i.kt)("h2",{id:"some-prep-work"},"\u51c6\u5907\u5de5\u4f5c"),(0,i.kt)("p",null,"\u5728\u521b\u5efa Collection \u4e4b\u524d\uff0c\u786e\u4fdd"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"\u5df2\u7ecf\u6839\u636e\u60a8\u7684\u6570\u636e\u5b8c\u6210\u4e86 Schema \u7684\u8bbe\u8ba1\u3002\u5982\u9700\u4e86\u89e3\u66f4\u591a\uff0c\u53ef\u9605\u8bfb",(0,i.kt)("a",{parentName:"p",href:"./data-models-explained"},"\u6570\u636e\u6a21\u578b"),"\u3002")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"\u5df2\u7ecf\u521b\u5efa\u4e86\u4e00\u4e2a\u96c6\u7fa4\u3002\u5982\u9700\u4e86\u89e3\u66f4\u591a\uff0c\u53ef\u9605\u8bfb",(0,i.kt)("a",{parentName:"p",href:"./create-cluster"},"\u521b\u5efa\u96c6\u7fa4"),"\u3002")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"\u5df2\u4e0b\u8f7d\u793a\u4f8b\u6570\u636e\u96c6\u3002\u8be6\u60c5\u8bf7\u53c2\u89c1",(0,i.kt)("a",{parentName:"p",href:"./example-dataset-1"},"\u793a\u4f8b\u6570\u636e\u96c6"),"\u3002"))),(0,i.kt)("h2",{id:"create-a-collection-with-partition-key-enabled"},"\u521b\u5efa\u542f\u7528 Partition Key \u7684 Collection"),(0,i.kt)("p",null,"\u4e3a\u4e86\u6f14\u793a Partition Key \u7684\u4f7f\u7528\uff0c\u6211\u4eec\u5c06\u7ee7\u7eed\u4f7f\u7528\u5305\u542b\u4e86 5,000 \u7bc7\u6587\u7ae0\u7684\u793a\u4f8b\u6570\u636e\u96c6\u3002\u5176\u4e2d\uff0c",(0,i.kt)("inlineCode",{parentName:"p"},"publication")," \u5c06\u4f5c\u4e3a Partition Key\u3002"),(0,i.kt)("p",null,"\u793a\u4f8b\u4ee3\u7801\u4e2d\u5c06\u521b\u5efa\u7684 Collection \u7684 Schema \u4e0e",(0,i.kt)("a",{parentName:"p",href:"./use-customized-schema"},"\u5b9a\u5236 Schema")," \u4e2d\u4f7f\u7528\u7684\u7c7b\u4f3c\u3002\u5dee\u5f02\u5c31\u5728\u4f5c\u4e3a Partition Key \u4f7f\u7528\u7684 ",(0,i.kt)("inlineCode",{parentName:"p"},"publication")," \u5b57\u6bb5\u3002"),(0,i.kt)(r.Z,{defaultValue:"python",values:[{label:"Python",value:"python"},{label:"NodeJS",value:"javascript"},{label:"Java",value:"java"},{label:"Go",value:"go"}],mdxType:"Tabs"},(0,i.kt)(l.Z,{value:"python",mdxType:"TabItem"},(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-python"},'# 2. Define fields\nfields = [\n    FieldSchema(name="id", dtype=DataType.INT64, is_primary=True),\n    FieldSchema(name="title", dtype=DataType.VARCHAR, max_length=512),\n    FieldSchema(name="title_vector", dtype=DataType.FLOAT_VECTOR, dim=768),\n    FieldSchema(name="link", dtype=DataType.VARCHAR, max_length=512),\n    FieldSchema(name="reading_time", dtype=DataType.INT64),\n    # set `is_partition_key` to `true` for the field `publication`\n    FieldSchema(name="publication", dtype=DataType.VARCHAR, is_partition_key = True, max_length=512),\n    FieldSchema(name="claps", dtype=DataType.INT64),\n    FieldSchema(name="responses", dtype=DataType.INT64)\n]\n'))),(0,i.kt)(l.Z,{value:"javascript",mdxType:"TabItem"},(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-javascript"},'// 2. Define Fields\n\n// You should include the following in the async function declaration.\n\nconst fields = [\n    {\n        name: "id",\n        data_type: DataType.Int64,\n        is_primary_key: true\n    },\n    {\n        name: "title",\n        data_type: DataType.VarChar,\n        max_length: 512,\n    },\n    {\n        name: "title_vector",\n        data_type: DataType.FloatVector,\n        dim: 768,\n    },\n    {\n        name: "link",\n        data_type: DataType.VarChar,\n        max_length: 512,\n    },\n    {\n        name: "reading_time",\n        data_type: DataType.Int64,\n    },\n    {\n        name: "publication",\n        data_type: DataType.VarChar,\n        max_length: 512,\n        // set `is_partition_key` to `true` for the field `publication`\n        is_partition_key: true\n    },\n    {\n        name: "claps",\n        data_type: DataType.Int64,\n    },\n    {\n        name: "responses",\n        data_type: DataType.Int64,\n    },\n];\n'))),(0,i.kt)(l.Z,{value:"java",mdxType:"TabItem"},(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},'// 2. Define fields\n\n// You should include the following in the main function\n\nFieldType id = FieldType.newBuilder()\n    .withName("id")\n    .withDataType(DataType.Int64)\n    .withPrimaryKey(true)\n    .withAutoID(true)\n    .build();\n\nFieldType title = FieldType.newBuilder()\n    .withName("title")\n    .withDataType(DataType.VarChar)\n    .withMaxLength(512)\n    .build();\n\nFieldType title_vector = FieldType.newBuilder()\n    .withName("title_vector")\n    .withDataType(DataType.FloatVector)\n    .withDimension(768)\n    .build();\n\nFieldType link = FieldType.newBuilder()\n    .withName("link")\n    .withDataType(DataType.VarChar)\n    .withMaxLength(512)\n    .build();\n\nFieldType reading_time = FieldType.newBuilder()\n    .withName("reading_time")\n    .withDataType(DataType.Int64)\n    .build();\n\nFieldType publication = FieldType.newBuilder()\n    .withName("publication")\n    .withDataType(DataType.VarChar)\n    .withMaxLength(512)\n    // Use `withPartitionKey()` to set the field `publication` as the partition key\n    .withPartitionKey(true)\n    .build();\n\nFieldType claps = FieldType.newBuilder()\n    .withName("claps")\n    .withDataType(DataType.Int64)\n    .build();\n\nFieldType responses = FieldType.newBuilder()\n    .withName("responses")\n    .withDataType(DataType.Int64)\n    .build();\n'))),(0,i.kt)(l.Z,{value:"go",mdxType:"TabItem"},(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-go"},'// 2. Define fields\n\n// You should include the following in the main function\n\nid := entity.NewField().\n        WithName("id").\n        WithDataType(entity.FieldTypeInt64).\n        WithIsPrimaryKey(true)\n\ntitle := entity.NewField().\n        WithName("title").\n        WithDataType(entity.FieldTypeVarChar).\n        WithMaxLength(512)\n\ntitle_vector := entity.NewField().\n        WithName("title_vector").\n        WithDataType(entity.FieldTypeFloatVector).\n        WithDim(768)\n\nlink := entity.NewField().\n        WithName("link").\n        WithDataType(entity.FieldTypeVarChar).\n        WithMaxLength(512)\n\nreading_time := entity.NewField().\n        WithName("reading_time").\n        WithDataType(entity.FieldTypeInt64)\n\npublication := entity.NewField().\n        WithName("publication").\n        WithDataType(entity.FieldTypeVarChar).\n        // Use `WithIsPartitionKey()` to set the field `publication` as the partition key\n        WithIsPartitionKey(true).\n        WithMaxLength(512)\n\nclaps := entity.NewField().\n        WithName("claps").\n        WithDataType(entity.FieldTypeInt64)\n\nresponses := entity.NewField().\n        WithName("responses").\n        WithDataType(entity.FieldTypeInt64)\n')))),(0,i.kt)("p",null,"\u5728\u5b8c\u6210\u5b57\u6bb5\u5b9a\u4e49\u4e4b\u540e\uff0c\u521b\u5efa Collection \u7684 Schema\u3002"),(0,i.kt)(r.Z,{defaultValue:"python",values:[{label:"Python",value:"python"},{label:"NodeJS",value:"javascript"},{label:"Java",value:"java"},{label:"Go",value:"go"}],mdxType:"Tabs"},(0,i.kt)(l.Z,{value:"python",mdxType:"TabItem"},(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-python"},'# 3. Build the schema\nschema = CollectionSchema(\n    fields,\n    description="Schema of Medium articles",\n    # This is an alternative to `is_partition_key` in field settings.\n    partition_key_field="publication"\n)\n'))),(0,i.kt)(l.Z,{value:"javascript",mdxType:"TabItem"},(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-javascript"},'// 3. Build the request for creating a collection\n// You should include the following in the async function declaration.\n\nconst collection_name = "medium_articles";\n\nconst req = {\n    collection_name,\n    fields\n}\n'))),(0,i.kt)(l.Z,{value:"java",mdxType:"TabItem"},(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},'// 3. Build the schema\n// You should include the following in the main function\n\nCreateCollectionParam createCollectionParam = CreateCollectionParam.newBuilder()\n    .withCollectionName("medium_articles")\n    .withDescription("Schema of Medium articles")\n    .addFieldType(id)\n    .addFieldType(title)\n    .addFieldType(title_vector)\n    .addFieldType(link)\n    .addFieldType(reading_time)\n    .addFieldType(publication)\n    .addFieldType(claps)\n    .addFieldType(responses)\n    .withEnableDynamicField(true)\n    .build();\n'))),(0,i.kt)(l.Z,{value:"go",mdxType:"TabItem"},(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-go"},'// 3. Build the schema\n// You should include the following in the main function\n\nschema := &entity.Schema{\n    CollectionName: "medium_articles",\n    Description:    "Medium articles published between Jan and August in 2020 in prominent publications",\n    AutoID:         true,\n    Fields: []*entity.Field{\n            id,\n            title,\n            title_vector,\n            link,\n            reading_time,\n            publication,\n            claps,\n            responses,\n    },\n}\n')))),(0,i.kt)("p",null,"\u6700\u540e\uff0c\u4f7f\u7528\u4e0a\u8ff0 Schema \u521b\u5efa Collection\u3002"),(0,i.kt)(r.Z,{defaultValue:"python",values:[{label:"Python",value:"python"},{label:"NodeJS",value:"javascript"},{label:"Java",value:"java"},{label:"Go",value:"go"}],mdxType:"Tabs"},(0,i.kt)(l.Z,{value:"python",mdxType:"TabItem"},(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-python"},'# 4. Create collection\ncollection = Collection(\n    name="medium_articles",\n    description="Medium articles published between Jan and August in 2020 in prominent publications",\n    schema=schema\n)\n'))),(0,i.kt)(l.Z,{value:"javascript",mdxType:"TabItem"},(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-javascript"},"// 4. Create collection\n// You should include the following in the async function declaration\n\nlet res = await client.createCollection(req);\n\nconsole.log(res)\n\n// Output\n// { error_code: 'Success', reason: '' }\n"))),(0,i.kt)(l.Z,{value:"java",mdxType:"TabItem"},(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},'// 4. Create collection\n\n// You should include the following in the main function\n\nR<RpcStatus> collection = client.createCollection(createCollectionParam);\n\nif (collection.getException() != null) {\n    System.out.println("Failed to create collection: " + collection.getException().getMessage());\n    return;\n}\n\nSystem.out.println("Collection created!");\n'))),(0,i.kt)(l.Z,{value:"go",mdxType:"TabItem"},(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-go"},'// 4. Create collection\n\n// You should include the following in the main function\n\ncolerr := conn.CreateCollection(context.Background(), schema, 2)\n\nif colerr != nil {\n        log.Fatal("Failed to create collection:", colerr.Error())\n}\n')))),(0,i.kt)("h2",{id:"ann-search-based-on-partition-key"},"\u57fa\u4e8e Partition Key \u7684 ANN \u641c\u7d22"),(0,i.kt)("p",null,"\u5728\u4e3a\u521b\u5efa\u7684 Collection \u5efa\u7acb\u7d22\u5f15\uff0c\u52a0\u8f7d\u7d22\u5f15\u6587\u4ef6\u81f3\u5185\u5b58\u5e76\u5c06\u793a\u4f8b\u6570\u636e\u96c6\u4e2d\u7684\u6570\u636e\u63d2\u5165 Collection \u540e\uff0c\u5c31\u53ef\u4ee5\u8fdb\u884c\u57fa\u4e8e Partition Key \u7684\u8fd1\u4f3c\u6700\u8fd1\u90bb\uff08ANN\uff09\u641c\u7d22\u4e86\u3002\u76f8\u5173\u64cd\u4f5c\uff0c\u53ef\u53c2\u8003",(0,i.kt)("a",{parentName:"p",href:"./use-customized-schema"},"\u5b9a\u5236 Schema"),"\u4e2d\u7684\u5177\u4f53\u5185\u5bb9\u3002"),(0,i.kt)("p",null,"\u5728\u521b\u5efa\u641c\u7d22\u8bf7\u6c42\u65f6\uff0c\u987b\u5728\u8bf7\u6c42\u4e2d\u5305\u542b\u5982\u4e0b\u8fc7\u6ee4\u8868\u8fbe\u5f0f\uff0c\u5e76\u5c06",(0,i.kt)("inlineCode",{parentName:"p"},"<partition_key>"),"\u66ff\u6362\u4e3a\u5b9e\u9645\u62c5\u4efb Partition Key \u7684\u5b57\u6bb5\u540d\u79f0\uff1a"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("inlineCode",{parentName:"p"},"expr='<partition_key>==\"xxx\"'"))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("inlineCode",{parentName:"p"},'expr=\'<partition_key> in ["xxx", "xxx"]\'')))),(0,i.kt)(r.Z,{defaultValue:"python",values:[{label:"Python",value:"python"},{label:"NodeJS",value:"javascript"},{label:"Java",value:"java"},{label:"Go",value:"go"}],mdxType:"Tabs"},(0,i.kt)(l.Z,{value:"python",mdxType:"TabItem"},(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-python"},'# 8. Search data\n\nresult = collection.search(\n    data=[rows[0][\'title_vector\']],\n    anns_field="title_vector",\n    param={"metric_type": "L2", "params": {"nprobe": 10}},\n    limit=3,\n    expr=\'claps > 30 and reading_time < 10 and publication in ["Towards Data Science", "Personal Growth"]\',\n    output_fields=["title", "link" ],\n)\n\n# Get all returned IDs\n# results[0] indicates the result\n# of the first query vector in the \'data\' list\nids = result[0].ids\n\nprint(ids)\n\n# Output:\n#\n# [5607, 5641, 3441]\n\n# Get the distance from\n# all returned vectors to the query vector.\ndistances = result[0].distances\n\nprint(distances)\n\n# Output:\n#\n# [0.36103835701942444, 0.37674015760421753, 0.4162980318069458]\n\n# Get the values of the output fields\n# specified in the search request\nhits = result[0]\nfor hit in hits:\n    print(hit.entity.get("title"))\n    print(hit.entity.get("link"))\n\n# Output:\n#\n# The Hidden Side Effect of the Coronavirus\n# <https://medium.com/swlh/the-hidden-side-effect-of-the-coronavirus-b6a7a5ee9586>\n# Why The Coronavirus Mortality Rate is Misleading\n# <https://towardsdatascience.com/why-the-coronavirus-mortality-rate-is-misleading-cc63f571b6a6>\n# Coronavirus shows what ethical Amazon could look like\n# <https://medium.com/swlh/coronavirus-shows-what-ethical-amazon-could-look-like-7c80baf2c663>\n'))),(0,i.kt)(l.Z,{value:"javascript",mdxType:"TabItem"},(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-javascript"},"// 8. Search data\n\n// You should include the following in the async function declaration\n\nres = await client.search({\n    collection_name,\n    vector: rows[0].title_vector,\n    limit: 3,\n    filter: \"claps > 30 and reading_time < 10 and publication in [\\\"Towards Data Science\\\", \\\"Personal Growth\\\"]\",\n    output_fields: [\"title\", \"link\"]\n});\n\nconsole.log(res);\n\n// Output:\n// {\n//   status: { error_code: 'Success', reason: '' },\n//   results: [\n//     {\n//       score: -0.8194807767868042,\n//       id: '5607',\n//       title: 'The Hidden Side Effect of the Coronavirus',\n//       link: '<https://medium.com/swlh/the-hidden-side-effect-of-the-coronavirus-b6a7a5ee9586>'\n//     },\n//     {\n//       score: -0.8116300106048584,\n//       id: '5641',\n//       title: 'Why The Coronavirus Mortality Rate is Misleading',\n//       link: '<https://towardsdatascience.com/why-the-coronavirus-mortality-rate-is-misleading-cc63f571b6a6>'\n//     },\n//     {\n//       score: -0.7918509244918823,\n//       id: '3441',\n//       title: 'Coronavirus shows what ethical Amazon could look like',\n//       link: '<https://medium.com/swlh/coronavirus-shows-what-ethical-amazon-could-look-like-7c80baf2c663>'\n//     }\n//   ]\n// }\n"))),(0,i.kt)(l.Z,{value:"java",mdxType:"TabItem"},(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},'// 8. Search data\n\n// You should include the following in the main function\n\nList<List<Float>> queryVectors = new ArrayList<>();\nList<Float> queryVector = rows.get(0).getJSONArray("title_vector").toJavaList(Float.class);\nqueryVectors.add(queryVector);\n\n// Prepare the outputFields\nList<String> outputFields = new ArrayList<>();\noutputFields.add("title");\noutputFields.add("link");\n\n// Search vectors in a collection\nSearchParam searchParam = SearchParam.newBuilder()\n    .withCollectionName("medium_articles")\n    .withVectorFieldName("title_vector")\n    .withVectors(queryVectors)\n    .withExpr("claps > 30 and reading_time < 10 and publication in [\\"Towards Data Science\\", \\"Personal Growth\\"]")\n    .withTopK(3)\n    .withMetricType(MetricType.L2)\n    .withParams("{\\\\"nprobe\\\\":10,\\\\"offset\\\\":2, \\\\"limit\\\\":3}")\n    .withConsistencyLevel(ConsistencyLevelEnum.BOUNDED)\n    .withOutFields(outputFields)\n    .build();\n\nR<SearchResults> response = client.search(searchParam);\n\nSearchResultsWrapper wrapper = new SearchResultsWrapper(response.getData().getResults());\nSystem.out.println("Search results");\n\nfor (int i = 0; i < queryVectors.size(); ++i) {\n    List<SearchResultsWrapper.IDScore> scores = wrapper.getIDScore(i);\n        List<String> titles = (List<String>) wrapper.getFieldData("title", i);\n    for (int j = 0; j < scores.size(); ++j) {\n        SearchResultsWrapper.IDScore score = scores.get(j);\n        System.out.println("Top " + j + " ID:" + score.getLongID() + " Distance:" + score.getScore());\n                System.out.println("Title: " + titles.get(j));\n        }\n}\n\n// Output\n// Search results\n// Top 0 ID:442206870369024034 Distance:0.41629803\n// Title: Coronavirus shows what ethical Amazon could look like\n// Top 1 ID:442206870369021531 Distance:0.4360938\n// Title: Mortality Rate As an Indicator of an Epidemic Outbreak\n// Top 2 ID:442206870369024868 Distance:0.48886314\n// Title: How Can AI Help Fight Coronavirus?\n'))),(0,i.kt)(l.Z,{value:"go",mdxType:"TabItem"},(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-go"},'// 8. Search data\n\n// You should include the following in the main function\n\nvectors := []entity.Vector{}\n\nfor _, row := range data.Rows[:1] {\n        vector := make(entity.FloatVector, 0, 768)\n        vector = append(vector, row.TitleVector...)\n        vectors = append(vectors, vector)\n}\n\n// Prepare the search parameters\nsp, _ := entity.NewIndexAUTOINDEXSearchParam(1)\n\nopt := client.SearchQueryOptionFunc(func(option *client.SearchQueryOption) {\n    option.Limit = 3\n    option.Offset = 0\n    option.ConsistencyLevel = entity.ClStrong\n    option.IgnoreGrowing = false\n})\n\n// Start the search\nsearchResults, err := conn.Search(\n        context.Background(),\n        "medium_articles",                // collection name\n        []string{},                       // partition name\n        "claps > 30 and reading_time < 10 and publication in [\\"Towards Data Science\\", \\"Personal Growth\\"]",                               // boolean expression\n        []string{"title", "publication"}, // output fields\n        vectors,                          // query vectors\n        "title_vector",                   // vector field name\n        entity.MetricType("L2"),          // metric type\n        3,                                // topK\n        sp,                               // search parameters\n        opt,                              // search options\n)\n\nif err != nil {\n        log.Fatal("Failed to search:", err.Error())\n}\n\n// Parse the search results\nfor i, sr := range searchResults {\n        log.Println("Result counts", i, ":", sr.ResultCount)\n\n        ids := sr.IDs.FieldData().GetScalars().GetLongData().GetData()\n        scores := sr.Scores\n        titles := sr.Fields.GetColumn("title").FieldData().GetScalars().GetStringData().GetData()\n        publications := sr.Fields.GetColumn("publication").FieldData().GetScalars().GetStringData().GetData()\n\n        for i, record := range ids {\n                log.Println("ID:", record, "Score:", scores[i], "Title:", titles[i], "Publication:", publications[i])\n        }\n\n}\n\n// Output\n// 2023/06/17 17:28:28 Result counts 0 : 3\n// 2023/06/17 17:28:28 ID: 0 Score: 0 Title: The Reported Mortality Rate of Coronavirus Is Not Important Publication: The Startup\n// 2023/06/17 17:28:28 ID: 3177 Score: 0.29999837 Title: Following the Spread of Coronavirus Publication: Towards Data Science\n// 2023/06/17 17:28:28 ID: 5607 Score: 0.36103836 Title: The Hidden Side Effect of the Coronavirus Publication: The Startup\n')))),(0,i.kt)("h2",{id:"typical-usage-scenarios"},"\u5178\u578b\u4f7f\u7528\u573a\u666f"),(0,i.kt)("p",null,"\u8be5\u7279\u6027\u53ef\u5728\u591a\u79df\u6237\u573a\u666f\u4e2d\u7528\u4e8e\u533a\u5206\u79df\u6237\u3002"),(0,i.kt)("p",null,"\u5177\u4f53\u6765\u8bf4\uff0c\u53ef\u4ee5\u5c06\u6bcf\u6761\u8bb0\u5f55\u4e2d\u7684\u67d0\u4e2a\u5b57\u6bb5\u786e\u5b9a\u4e3a Partition Key\u3002\u5f53\u8fdb\u884c\u641c\u7d22\u6216\u67e5\u8be2\u65f6\uff0c\u53ef\u4ee5\u7528\u8be5\u5b57\u6bb5\u8fc7\u6ee4\u67e5\u8be2\u7ed3\u679c\uff0c\u5b9e\u73b0\u79df\u6237\u6570\u636e\u9694\u79bb\u7684\u540c\u65f6\uff0c\u907f\u514d\u5728\u67e5\u8be2\u65f6\u626b\u63cf\u5176\u5b83\u79df\u6237\u7684 Partition\u3002"))}h.isMDXComponent=!0}}]);